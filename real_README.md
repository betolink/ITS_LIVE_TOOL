# itslivetools

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

# About

`ITS_LIVE_TOOL` is a package designed to aid users working with the
[Inter-mission Time Series of Land Ice Velocity and Elevation](link)
(ITS_LIVE) dataset. The package provides functions for accessing data as
well as various methods to process ITS_LIVE observations. This notebook
will demonstrate various elements of the package and walk through the
steps of a typical workflow using ITS_LIVE_TOOL.

## Overview

``` {note}
keep this overview here? or move to readme doc?
```

The tools in the package fall into two main categories: 1) data access +
organization, 2) data processing.

### Data Access + Organization

#### 1. Interactive map widget

This is an interactive widget design to streamline access ITS_LIVE image
pair ice velocity time series.

#### 2. [`Glacier`](https://e-marshall.github.io/ITS_LIVE_TOOL/obj_setup.html#glacier), [`Glacier_Centerline`](https://e-marshall.github.io/ITS_LIVE_TOOL/obj_setup.html#glacier_centerline), [`Glacier_Point`](https://e-marshall.github.io/ITS_LIVE_TOOL/obj_setup.html#glacier_point) objects

These are provided to store and keep track of different types of data
related to individual units of analysis such as points, centerlines or
full glacier surface areas.

This roadmap document will first demonstrate data access and
organization tools before demonstrating the processing tools.

### Data Processing

We demonstrate and make available two processing routines. Be sure to
check out the accompanying [book]() and consider if either of these are
appropriate for your data and use case. Note that these methods are in
active development and thus should be considered in *beta* phase. Please
perform your own data inspection and due diligence if implementing these
methods.

#### Inversion

**to add** Description – link to full description and examples

#### Gaussian Process Regression

**to add** Description – link to full description and examples

### Processing

We demonstrate and make available two processing routines. Be sure to
check out the accompanying [book]() and consider if either of these are
appropriate for your data and use case. Note that these methods are in
active development and thus should be considered in *beta* phase. Please
perform your own data inspection and due diligence if implementing these
methods.

``` python
from ITS_LIVE_TOOL import datacube_tools, interactive, obj_setup
```

``` python
import os
import numpy as np
import pyproj
import matplotlib.path as path
import s3fs
import zarr
import matplotlib.pyplot as plt
import scipy
from datetime import timedelta
from tqdm import tqdm
import xarray as xr
import re
import pandas as pd
import geopandas as gpd
import matplotlib.path as mplp
import ipyleaflet as ipyl
from ipyleaflet import WMSLayer
import ipywidgets as ipyw
import json
import pandas as pd
from ipyleaflet import Map, WMSLayer, basemaps
from ipywidgets import HTML
from owslib.wms import WebMapService
```

## Install

Install this package using the below command

``` {note}
someday we hope to have a pip or conda install, for now use pip install git+ github repo url
```

# Section 1: Data Access + Organization

### How to use

There are two ways to access data using ITS_LIVE_TOOL. The first way is
through the interactive widget. This is great for exploratory analysis.
The second way is by specifying an RGI ID and point coordinates
manually. This is useful if you already know which glacier(s) you want
to examine and simply want to pass a list of RGI IDs and coordinates.
We’ll first demonstrate using the interactive widget.

### Interactive data selection widget

First, use the interactive map to select data. Do this by right- and
left-clicking on the map location where you’d like to access data. This
will return an object containing the coordinates of the point you
clicked, a `geopandas.GeoDataFrame` of the
[RGI7](http://www.glims.org/rgi_user_guide/welcome.html) data for that
glacier and the URL of the ITS_LIVE granule covering the clicked point.

``` {note}
If the glacier you want to study lies in multiple ITS_LIVE granules, or you'd like to look at multiple glaciers, click in multiple points and the output objects will be appended with each click. 
```

``` python
data_map = interactive.Widget()
```

``` python
data_map.display()
```

    VBox(children=(Map(center=[0, 0], controls=(ZoomControl(options=['position', 'zoom_in_text', 'zoom_in_title', …

### Create data objects

Once you have made your selection(s) on the map, use the following
methods to create objects that will store your data

#### If you’ve only selected one glacier, create individual objects as follows:

``` python
data_map.urls
```

    ['http://its-live-data.s3.amazonaws.com/datacubes/v2/N50W140/ITS_LIVE_vel_EPSG3413_G0120_X-3350000_Y350000.zarr',
     'http://its-live-data.s3.amazonaws.com/datacubes/v2/N60W140/ITS_LIVE_vel_EPSG3413_G0120_X-3250000_Y350000.zarr',
     'http://its-live-data.s3.amazonaws.com/datacubes/v2/N50W130/ITS_LIVE_vel_EPSG3413_G0120_X-3350000_Y250000.zarr',
     'http://its-live-data.s3.amazonaws.com/datacubes/v2/N60W130/ITS_LIVE_vel_EPSG3413_G0120_X-3250000_Y250000.zarr']

``` python
glacier = obj_setup.create_glacier_from_click(data_map, 0)
```

``` python
glacier.itslive_url
```

    'http://its-live-data.s3.amazonaws.com/datacubes/v2/N50W140/ITS_LIVE_vel_EPSG3413_G0120_X-3350000_Y350000.zarr'

``` python
glacier_point = obj_setup.create_glacier_point_from_click(data_map, 0, 'phony label')
```

    original xy [-143.04795214410368, 60.37791914446092] 4326 maps to datacube (-3247134.1548154885, 459126.5490621218) EPSG:3413
    original xy [-143.04795214410368, 60.37791914446092] 4326 maps to datacube (-3247134.1548154885, 459126.5490621218) EPSG:3413
    subset and load at  63.19 seconds


    KeyboardInterrupt

``` python
glacier_centerline = obj_setup.create_glacier_centerline_from_click(data_map, 0)
```

As you can see, these objects all store data related to the same glacier
that was selected, but at different spatial scales. The `glacier` object
contains an RGIID, name and the RGI outline and attributes for that
glacier.

``` python
glacier.outline_prj
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

|     | id               | CENLON   | ZMAX | BGNDATE  | ZMIN | RGIID          | ASPECT | CENLAT | SLOPE | ZMED | ... | TERMTYPE | O2REGION | STATUS | ENDDATE  | FORM | SURGING | GLIMSID        | O1REGION | NAME           | geometry                                          |
|-----|------------------|----------|------|----------|------|----------------|--------|--------|-------|------|-----|----------|----------|--------|----------|------|---------|----------------|----------|----------------|---------------------------------------------------|
| 0   | RGI_Alaska.13631 | -142.072 | 5381 | 20100910 | 3    | RGI60-01.13635 | 273    | 60.461 | 9     | 1525 | ... | 2        | 5        | 0      | -9999999 | 0    | 9       | G217928E60461N | 1        | Bering Glacier | MULTIPOLYGON (((506808.975 6723108.546, 506874... |

<p>1 rows × 24 columns</p>
</div>

The `glacier_point` object also has the RGI ID and name inherited from
the map widget but additionally contains ITS_LIVE image pair velocity
time series data for the selected point as well as a 3x3 pixel cube
surrounding the point.

``` python
glacier_point.cube_around_point
```

<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */
&#10;:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}
&#10;html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}
&#10;.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}
&#10;.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}
&#10;.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}
&#10;.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}
&#10;.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}
&#10;.xr-obj-type {
  color: var(--xr-font-color2);
}
&#10;.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}
&#10;.xr-section-item {
  display: contents;
}
&#10;.xr-section-item input {
  display: none;
}
&#10;.xr-section-item input + label {
  color: var(--xr-disabled-color);
}
&#10;.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}
&#10;.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}
&#10;.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}
&#10;.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}
&#10;.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}
&#10;.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}
&#10;.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}
&#10;.xr-section-summary-in:checked + label:before {
  content: '▼';
}
&#10;.xr-section-summary-in:checked + label > span {
  display: none;
}
&#10;.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}
&#10;.xr-section-inline-details {
  grid-column: 2 / -1;
}
&#10;.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}
&#10;.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}
&#10;.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}
&#10;.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}
&#10;.xr-preview {
  color: var(--xr-font-color3);
}
&#10;.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}
&#10;.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}
&#10;.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}
&#10;.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}
&#10;.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}
&#10;.xr-dim-list:before {
  content: '(';
}
&#10;.xr-dim-list:after {
  content: ')';
}
&#10;.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}
&#10;.xr-has-index {
  font-weight: bold;
}
&#10;.xr-var-list,
.xr-var-item {
  display: contents;
}
&#10;.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}
&#10;.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}
&#10;.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}
&#10;.xr-var-name {
  grid-column: 1;
}
&#10;.xr-var-dims {
  grid-column: 2;
}
&#10;.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}
&#10;.xr-var-preview {
  grid-column: 4;
}
&#10;.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}
&#10;.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}
&#10;.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}
&#10;.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}
&#10;.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}
&#10;.xr-var-data > table {
  float: right;
}
&#10;.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}
&#10;.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}
&#10;dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}
&#10;.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}
&#10;.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}
&#10;.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}
&#10;.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}
&#10;.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                (mid_date: 21894, x: 3, y: 4)
Coordinates:
  * mid_date               (mid_date) datetime64[ns] 2020-10-27T20:55:56.2010...
  * x                      (x) float64 -3.247e+06 -3.247e+06 -3.247e+06
  * y                      (y) float64 4.593e+05 4.592e+05 4.591e+05 4.589e+05
    step_count             (mid_date) int64 0 5 12 14 ... 76928 76941 76952
    mapping                int64 0
Data variables:
    v                      (mid_date, y, x) float32 nan 182.0 nan ... 11.0 nan
    vy                     (mid_date, y, x) float32 nan -131.0 nan ... 11.0 nan
    vx                     (mid_date, y, x) float32 nan -126.0 nan ... 2.0 nan
    v_error                (mid_date, y, x) float32 nan 53.0 nan ... nan 6.0 nan
    satellite_img1         (mid_date) object &#x27;2A&#x27; &#x27;2A&#x27; &#x27;2A&#x27; &#x27;2B&#x27; ... &#x27;7&#x27; &#x27;7&#x27; &#x27;7&#x27;
    satellite_img2         (mid_date) object &#x27;2A&#x27; &#x27;2A&#x27; &#x27;2B&#x27; &#x27;2B&#x27; ... &#x27;8&#x27; &#x27;8&#x27; &#x27;8&#x27;
    acquisition_date_img1  (mid_date) datetime64[ns] 2020-10-17T20:55:01 ... ...
    acquisition_date_img2  (mid_date) datetime64[ns] 2020-11-06T20:56:51.0000...
    img_separation         (mid_date) float64 21.0 500.0 535.0 ... 217.0 312.0
Attributes: (12/19)
    Conventions:                CF-1.8
    GDAL_AREA_OR_POINT:         Area
    author:                     ITS_LIVE, a NASA MEaSUREs project (its-live.j...
    autoRIFT_parameter_file:    http://its-live-data.s3.amazonaws.com/autorif...
    datacube_software_version:  1.0
    date_created:               25-Sep-2023 22:55:04
    ...                         ...
    s3:                         s3://its-live-data/datacubes/v2/N60W140/ITS_L...
    skipped_granules:           s3://its-live-data/datacubes/v2/N60W140/ITS_L...
    time_standard_img1:         UTC
    time_standard_img2:         UTC
    title:                      ITS_LIVE datacube of image pair velocities
    url:                        https://its-live-data.s3.amazonaws.com/datacu...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-22a30c4e-defb-44e9-8697-a43551b24855' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-22a30c4e-defb-44e9-8697-a43551b24855' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>mid_date</span>: 21894</li><li><span class='xr-has-index'>x</span>: 3</li><li><span class='xr-has-index'>y</span>: 4</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-7efbd927-5a07-411f-8acc-15b20d97937a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7efbd927-5a07-411f-8acc-15b20d97937a' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>mid_date</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-10-27T20:55:56.201017088 .....</div><input id='attrs-b2abbd34-7064-4c19-8714-2e69d3eef461' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b2abbd34-7064-4c19-8714-2e69d3eef461' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3b074b7a-6491-4cb4-9083-b4544538ad58' class='xr-var-data-in' type='checkbox'><label for='data-3b074b7a-6491-4cb4-9083-b4544538ad58' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>midpoint of image 1 and image 2 acquisition date and time with granule&#x27;s centroid longitude and latitude as microseconds</dd><dt><span>standard_name :</span></dt><dd>image_pair_center_date_with_time_separation</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-10-27T20:55:56.201017088&#x27;, &#x27;2018-07-23T21:04:06.171115008&#x27;,
       &#x27;2020-11-07T09:03:10.200212992&#x27;, ..., &#x27;2013-04-17T20:35:17.494323968&#x27;,
       &#x27;2014-09-10T20:42:02.202106880&#x27;, &#x27;2018-03-06T20:38:07.625047040&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-3.247e+06 -3.247e+06 -3.247e+06</div><input id='attrs-59e86d1c-423a-4de9-9ee3-9dc193d27254' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-59e86d1c-423a-4de9-9ee3-9dc193d27254' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e0eabfa1-120e-4cc4-9c60-3814db5706af' class='xr-var-data-in' type='checkbox'><label for='data-e0eabfa1-120e-4cc4-9c60-3814db5706af' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>x coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>x coordinate of projection</dd><dt><span>units :</span></dt><dd>metre</dd></dl></div><div class='xr-var-data'><pre>array([-3247267.5, -3247147.5, -3247027.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.593e+05 4.592e+05 ... 4.589e+05</div><input id='attrs-7286437a-9772-4669-aada-7251510c6411' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7286437a-9772-4669-aada-7251510c6411' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c1e34ae9-0ba8-402a-9875-a0370a8e6b7b' class='xr-var-data-in' type='checkbox'><label for='data-c1e34ae9-0ba8-402a-9875-a0370a8e6b7b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>y coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>y coordinate of projection</dd><dt><span>units :</span></dt><dd>metre</dd></dl></div><div class='xr-var-data'><pre>array([459307.5, 459187.5, 459067.5, 458947.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>step_count</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 5 12 14 ... 76928 76941 76952</div><input id='attrs-45b77e26-44b3-4f5d-9dab-60835bbdf621' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-45b77e26-44b3-4f5d-9dab-60835bbdf621' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-07e02db1-de08-4fd0-ae98-e77f1022be78' class='xr-var-data-in' type='checkbox'><label for='data-07e02db1-de08-4fd0-ae98-e77f1022be78' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([    0,     5,    12, ..., 76928, 76941, 76952])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>mapping</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-daa5310c-edd7-4bad-8400-ad58635e13bc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-daa5310c-edd7-4bad-8400-ad58635e13bc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5fd55d31-1a65-466e-8594-e5e710627a0d' class='xr-var-data-in' type='checkbox'><label for='data-5fd55d31-1a65-466e-8594-e5e710627a0d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>PROJCS[&quot;WGS 84 / NSIDC Sea Ice Polar Stereographic North&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Polar_Stereographic&quot;],PARAMETER[&quot;latitude_of_origin&quot;,70],PARAMETER[&quot;central_meridian&quot;,-45],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,SOUTH],AXIS[&quot;Northing&quot;,SOUTH],AUTHORITY[&quot;EPSG&quot;,&quot;3413&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984</dd><dt><span>projected_crs_name :</span></dt><dd>WGS 84 / NSIDC Sea Ice Polar Stereographic North</dd><dt><span>grid_mapping_name :</span></dt><dd>polar_stereographic</dd><dt><span>standard_parallel :</span></dt><dd>70.0</dd><dt><span>straight_vertical_longitude_from_pole :</span></dt><dd>-45.0</dd><dt><span>false_easting :</span></dt><dd>0.0</dd><dt><span>false_northing :</span></dt><dd>0.0</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS[&quot;WGS 84 / NSIDC Sea Ice Polar Stereographic North&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Polar_Stereographic&quot;],PARAMETER[&quot;latitude_of_origin&quot;,70],PARAMETER[&quot;central_meridian&quot;,-45],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,SOUTH],AXIS[&quot;Northing&quot;,SOUTH],AUTHORITY[&quot;EPSG&quot;,&quot;3413&quot;]]</dd><dt><span>GeoTransform :</span></dt><dd>-3247327.5 120.0 0.0 459367.5 0.0 -120.0</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-eb9a725e-0c83-4ad3-a3a5-a03833d8fa4c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-eb9a725e-0c83-4ad3-a3a5-a03833d8fa4c' class='xr-section-summary' >Data variables: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(mid_date, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan 182.0 nan ... nan 11.0 nan</div><input id='attrs-8fdbda0f-e16e-4305-85a5-64c18c00e604' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8fdbda0f-e16e-4305-85a5-64c18c00e604' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7ca64435-3ce0-4176-88f4-e214abc689f0' class='xr-var-data-in' type='checkbox'><label for='data-7ca64435-3ce0-4176-88f4-e214abc689f0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>velocity magnitude</dd><dt><span>grid_mapping :</span></dt><dd>mapping</dd><dt><span>standard_name :</span></dt><dd>land_ice_surface_velocity</dd><dt><span>units :</span></dt><dd>meter/year</dd></dl></div><div class='xr-var-data'><pre>array([[[ nan, 182.,  nan],
        [171., 170., 129.],
        [151., 177., 157.],
        [ nan, 153.,  nan]],
&#10;       [[ nan,  nan,  nan],
        [ nan,  nan,  nan],
        [ nan,  nan,  nan],
        [ nan,  nan,  nan]],
&#10;       [[ nan,  nan,  nan],
        [ nan,  nan,  nan],
        [ nan,  nan,  nan],
        [ nan,  nan,  nan]],
&#10;       ...,
&#10;       [[ nan, 345.,  nan],
        [341., 354., 367.],
        [344., 363., 381.],
        [ nan, 366.,  nan]],
&#10;       [[ nan,  51.,  nan],
        [ 43.,  52.,  59.],
        [ 45.,  53.,  57.],
        [ nan,  53.,  nan]],
&#10;       [[ nan,  13.,  nan],
        [ 11.,  12.,  nan],
        [ 10.,  11.,  nan],
        [ nan,  11.,  nan]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vy</span></div><div class='xr-var-dims'>(mid_date, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan -131.0 nan ... nan 11.0 nan</div><input id='attrs-b2ebaacf-af4e-444d-a7a5-8e29bc0b9093' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b2ebaacf-af4e-444d-a7a5-8e29bc0b9093' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-538de3c0-7935-4b09-a4bc-bd79ea11747a' class='xr-var-data-in' type='checkbox'><label for='data-538de3c0-7935-4b09-a4bc-bd79ea11747a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>velocity component in y direction</dd><dt><span>grid_mapping :</span></dt><dd>mapping</dd><dt><span>standard_name :</span></dt><dd>land_ice_surface_y_velocity</dd><dt><span>units :</span></dt><dd>meter/year</dd></dl></div><div class='xr-var-data'><pre>array([[[  nan, -131.,   nan],
        [-117., -115.,  -59.],
        [-100., -118.,  -87.],
        [  nan,  -87.,   nan]],
&#10;       [[  nan,   nan,   nan],
        [  nan,   nan,   nan],
        [  nan,   nan,   nan],
        [  nan,   nan,   nan]],
&#10;       [[  nan,   nan,   nan],
        [  nan,   nan,   nan],
        [  nan,   nan,   nan],
        [  nan,   nan,   nan]],
&#10;       ...,
&#10;       [[  nan,  345.,   nan],
        [ 341.,  354.,  367.],
        [ 344.,  363.,  381.],
        [  nan,  366.,   nan]],
&#10;       [[  nan,  -42.,   nan],
        [ -33.,  -44.,  -53.],
        [ -35.,  -44.,  -50.],
        [  nan,  -44.,   nan]],
&#10;       [[  nan,   12.,   nan],
        [  10.,   11.,   nan],
        [  10.,   11.,   nan],
        [  nan,   11.,   nan]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vx</span></div><div class='xr-var-dims'>(mid_date, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan -126.0 nan ... nan 2.0 nan</div><input id='attrs-fb558dc5-36c7-4935-ad7a-f6b205e54f03' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fb558dc5-36c7-4935-ad7a-f6b205e54f03' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b61d85dc-9f90-4c97-90f4-b4ff3cf6eb3e' class='xr-var-data-in' type='checkbox'><label for='data-b61d85dc-9f90-4c97-90f4-b4ff3cf6eb3e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>velocity component in x direction</dd><dt><span>grid_mapping :</span></dt><dd>mapping</dd><dt><span>standard_name :</span></dt><dd>land_ice_surface_x_velocity</dd><dt><span>units :</span></dt><dd>meter/year</dd></dl></div><div class='xr-var-data'><pre>array([[[  nan, -126.,   nan],
        [-124., -126., -115.],
        [-112., -132., -131.],
        [  nan, -126.,   nan]],
&#10;       [[  nan,   nan,   nan],
        [  nan,   nan,   nan],
        [  nan,   nan,   nan],
        [  nan,   nan,   nan]],
&#10;       [[  nan,   nan,   nan],
        [  nan,   nan,   nan],
        [  nan,   nan,   nan],
        [  nan,   nan,   nan]],
&#10;       ...,
&#10;       [[  nan,    7.,   nan],
        [   7.,    5.,    3.],
        [   7.,    4.,    0.],
        [  nan,    3.,   nan]],
&#10;       [[  nan,  -27.,   nan],
        [ -28.,  -28.,  -27.],
        [ -29.,  -28.,  -28.],
        [  nan,  -28.,   nan]],
&#10;       [[  nan,   -6.,   nan],
        [  -4.,   -3.,   nan],
        [  -1.,    0.,   nan],
        [  nan,    2.,   nan]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v_error</span></div><div class='xr-var-dims'>(mid_date, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan 53.0 nan 54.0 ... nan 6.0 nan</div><input id='attrs-20187384-d0b7-4808-8f8a-aa0358469c00' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-20187384-d0b7-4808-8f8a-aa0358469c00' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dec61493-c777-45bf-ba73-2ef23d62f5ae' class='xr-var-data-in' type='checkbox'><label for='data-dec61493-c777-45bf-ba73-2ef23d62f5ae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>velocity magnitude error</dd><dt><span>grid_mapping :</span></dt><dd>mapping</dd><dt><span>standard_name :</span></dt><dd>velocity_error</dd><dt><span>units :</span></dt><dd>meter/year</dd></dl></div><div class='xr-var-data'><pre>array([[[nan, 53., nan],
        [54., 54., 59.],
        [54., 55., 57.],
        [nan, 57., nan]],
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       ...,
&#10;       [[nan,  3., nan],
        [ 3.,  3.,  3.],
        [ 3.,  3.,  3.],
        [nan,  3., nan]],
&#10;       [[nan,  8., nan],
        [ 9.,  8.,  8.],
        [ 9.,  8.,  8.],
        [nan,  8., nan]],
&#10;       [[nan,  6., nan],
        [ 6.,  6., nan],
        [ 6.,  6., nan],
        [nan,  6., nan]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>satellite_img1</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;2A&#x27; &#x27;2A&#x27; &#x27;2A&#x27; &#x27;2B&#x27; ... &#x27;7&#x27; &#x27;7&#x27; &#x27;7&#x27;</div><input id='attrs-9dc764eb-1d14-415f-94ac-04c43d8096cb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9dc764eb-1d14-415f-94ac-04c43d8096cb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-45dbf68a-4e21-4cef-b63d-8742b096dc56' class='xr-var-data-in' type='checkbox'><label for='data-45dbf68a-4e21-4cef-b63d-8742b096dc56' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>id of the satellite that acquired image 1</dd><dt><span>standard_name :</span></dt><dd>image1_satellite</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2A&#x27;, &#x27;2A&#x27;, &#x27;2A&#x27;, ..., &#x27;7&#x27;, &#x27;7&#x27;, &#x27;7&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>satellite_img2</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;2A&#x27; &#x27;2A&#x27; &#x27;2B&#x27; &#x27;2B&#x27; ... &#x27;8&#x27; &#x27;8&#x27; &#x27;8&#x27;</div><input id='attrs-93ad957a-0da6-4382-a01f-159928f9dcbf' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-93ad957a-0da6-4382-a01f-159928f9dcbf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-be60ff78-441d-4567-b81f-dd6d7d3a6d30' class='xr-var-data-in' type='checkbox'><label for='data-be60ff78-441d-4567-b81f-dd6d7d3a6d30' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>id of the satellite that acquired image 2</dd><dt><span>standard_name :</span></dt><dd>image2_satellite</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2A&#x27;, &#x27;2A&#x27;, &#x27;2B&#x27;, ..., &#x27;8&#x27;, &#x27;8&#x27;, &#x27;8&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>acquisition_date_img1</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-10-17T20:55:01 ... 2017-10-...</div><input id='attrs-20d15c0d-5810-48e9-83b8-07ed0f364e4e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-20d15c0d-5810-48e9-83b8-07ed0f364e4e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e7e7bdaf-ebcf-467e-972a-c10a9e3f96d2' class='xr-var-data-in' type='checkbox'><label for='data-e7e7bdaf-ebcf-467e-972a-c10a9e3f96d2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-10-17T20:55:01.000000000&#x27;, &#x27;2017-11-15T21:07:31.000000256&#x27;,
       &#x27;2020-02-13T21:05:51.000000000&#x27;, ...,
       &#x27;2012-07-31T20:32:04.164824064&#x27;, &#x27;2014-05-25T20:40:40.931047936&#x27;,
       &#x27;2017-10-01T20:39:43.879059968&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>acquisition_date_img2</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-11-06T20:56:51.000000256 .....</div><input id='attrs-53a58a87-2156-4be3-b140-aa7a1f9ad965' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-53a58a87-2156-4be3-b140-aa7a1f9ad965' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1e473588-0929-413c-8c81-103fcbdee5bc' class='xr-var-data-in' type='checkbox'><label for='data-1e473588-0929-413c-8c81-103fcbdee5bc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-11-06T20:56:51.000000256&#x27;, &#x27;2019-03-30T21:00:41.000000256&#x27;,
       &#x27;2021-08-01T21:00:28.999999744&#x27;, ...,
       &#x27;2014-01-02T20:38:30.582362112&#x27;, &#x27;2014-12-27T20:43:23.192114944&#x27;,
       &#x27;2018-08-09T20:36:31.029031936&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>img_separation</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>21.0 500.0 535.0 ... 217.0 312.0</div><input id='attrs-f1a4fdea-1108-4c31-8454-37bf4ae35ce5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f1a4fdea-1108-4c31-8454-37bf4ae35ce5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-18c7a439-d242-4859-baad-abc242291324' class='xr-var-data-in' type='checkbox'><label for='data-18c7a439-d242-4859-baad-abc242291324' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 21., 500., 535., ..., 521., 217., 312.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-80b54fed-faed-4bf4-9634-56de55e00b7a' class='xr-section-summary-in' type='checkbox'  ><label for='section-80b54fed-faed-4bf4-9634-56de55e00b7a' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>mid_date</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-794b39b2-ef34-4e87-b427-0c70ccc65267' class='xr-index-data-in' type='checkbox'/><label for='index-794b39b2-ef34-4e87-b427-0c70ccc65267' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2020-10-27 20:55:56.201017088&#x27;,
               &#x27;2018-07-23 21:04:06.171115008&#x27;,
               &#x27;2020-11-07 09:03:10.200212992&#x27;,
               &#x27;2021-03-14 21:03:39.210202112&#x27;,
               &#x27;2019-02-08 21:06:11.190118912&#x27;,
               &#x27;2021-03-02 09:04:10.200612096&#x27;,
               &#x27;2003-06-27 20:38:01.737421056&#x27;,
               &#x27;2019-07-16 09:00:25.190612736&#x27;,
               &#x27;2018-03-12 20:53:26.171102208&#x27;,
               &#x27;2022-01-25 20:50:24.210729216&#x27;,
               ...
               &#x27;2019-01-08 20:36:43.441349120&#x27;,
               &#x27;2014-03-18 20:42:38.039596032&#x27;,
               &#x27;2019-05-06 20:49:39.263644928&#x27;,
               &#x27;2017-04-18 20:50:58.391631104&#x27;,
               &#x27;2018-10-04 20:36:47.307171072&#x27;,
               &#x27;2018-11-21 20:36:39.429436928&#x27;,
               &#x27;2016-10-17 20:44:40.555608320&#x27;,
               &#x27;2013-04-17 20:35:17.494323968&#x27;,
               &#x27;2014-09-10 20:42:02.202106880&#x27;,
               &#x27;2018-03-06 20:38:07.625047040&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;mid_date&#x27;, length=21894, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d2873841-0161-4fe2-965a-cf12273717eb' class='xr-index-data-in' type='checkbox'/><label for='index-d2873841-0161-4fe2-965a-cf12273717eb' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-3247267.5, -3247147.5, -3247027.5], dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-8625b719-780c-4446-909d-c8fa1c702146' class='xr-index-data-in' type='checkbox'/><label for='index-8625b719-780c-4446-909d-c8fa1c702146' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([459307.5, 459187.5, 459067.5, 458947.5], dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a7239b27-a17c-4401-a12d-9d2c5f1b5f33' class='xr-section-summary-in' type='checkbox'  ><label for='section-a7239b27-a17c-4401-a12d-9d2c5f1b5f33' class='xr-section-summary' >Attributes: <span>(19)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>GDAL_AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>author :</span></dt><dd>ITS_LIVE, a NASA MEaSUREs project (its-live.jpl.nasa.gov)</dd><dt><span>autoRIFT_parameter_file :</span></dt><dd>http://its-live-data.s3.amazonaws.com/autorift_parameters/v001/autorift_landice_0120m.shp</dd><dt><span>datacube_software_version :</span></dt><dd>1.0</dd><dt><span>date_created :</span></dt><dd>25-Sep-2023 22:55:04</dd><dt><span>date_updated :</span></dt><dd>25-Sep-2023 22:55:04</dd><dt><span>geo_polygon :</span></dt><dd>[[-141.91122711902466, 59.991418873895434], [-141.96346852648804, 60.20581365570371], [-142.01650174472292, 60.420390625252345], [-142.0703448201576, 60.63514798270625], [-142.12501634890182, 60.85008390249138], [-142.5653210684323, 60.82238129995041], [-143.00472885729283, 60.79303336456097], [-143.44319092917664, 60.76204591313584], [-143.88065915052024, 60.72942506278064], [-143.8129016377444, 60.5155194536589], [-143.7461622625552, 60.30177766503498], [-143.6804184250713, 60.08820184313313], [-143.61564818416412, 59.87479409917137], [-143.1908613764634, 59.90632723723632], [-142.76516601842533, 59.93627943895268], [-142.33860633623624, 59.96464509520569], [-141.91122711902466, 59.991418873895434]]</dd><dt><span>institution :</span></dt><dd>NASA Jet Propulsion Laboratory (JPL), California Institute of Technology</dd><dt><span>latitude :</span></dt><dd>60.36</dd><dt><span>longitude :</span></dt><dd>-142.88</dd><dt><span>proj_polygon :</span></dt><dd>[[-3300000, 400000], [-3275000.0, 400000.0], [-3250000.0, 400000.0], [-3225000.0, 400000.0], [-3200000, 400000], [-3200000.0, 425000.0], [-3200000.0, 450000.0], [-3200000.0, 475000.0], [-3200000, 500000], [-3225000.0, 500000.0], [-3250000.0, 500000.0], [-3275000.0, 500000.0], [-3300000, 500000], [-3300000.0, 475000.0], [-3300000.0, 450000.0], [-3300000.0, 425000.0], [-3300000, 400000]]</dd><dt><span>projection :</span></dt><dd>3413</dd><dt><span>s3 :</span></dt><dd>s3://its-live-data/datacubes/v2/N60W140/ITS_LIVE_vel_EPSG3413_G0120_X-3250000_Y450000.zarr</dd><dt><span>skipped_granules :</span></dt><dd>s3://its-live-data/datacubes/v2/N60W140/ITS_LIVE_vel_EPSG3413_G0120_X-3250000_Y450000.json</dd><dt><span>time_standard_img1 :</span></dt><dd>UTC</dd><dt><span>time_standard_img2 :</span></dt><dd>UTC</dd><dt><span>title :</span></dt><dd>ITS_LIVE datacube of image pair velocities</dd><dt><span>url :</span></dt><dd>https://its-live-data.s3.amazonaws.com/datacubes/v2/N60W140/ITS_LIVE_vel_EPSG3413_G0120_X-3250000_Y450000.zarr</dd></dl></div></li></ul></div></div>

The `glacier_centerline` object contains the same RGIID and name
information as the first two objects. In addition, it contains OGGM
centerline data that are stored as geopandas GeodataFrames.

``` python
glacier_centerline.main_centerline
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

|       | RGIID          | SEGMENT_ID | LE_SEGMENT | MAIN | geometry                                          |
|-------|----------------|------------|------------|------|---------------------------------------------------|
| 19617 | RGI60-01.13635 | 40         | 212562.0   | 1    | LINESTRING (522733.337 6719455.665, 522730.077... |

</div>

Each of these objects are meant to act as cotainers to intuitively and
efficiently store different types of data as you process and continue to
work with ITS_LIVE data.

The previous steps demonstrated the data access and organization
functionality of ITS_LIVE_TOOl. The subsequent sections of this notebook
will demonstrate different processing methodologies for working with
this dataset.

#### If you’ve selected multiple glaciers, follow these examples:

``` python
glacier0, glacier1 = obj_setup.create_multiple_glacier_objs(data_map)[0], obj_setup.create_multiple_glacier_objs(data_map)[1]
```

``` python
glacier_point_ls = obj_setup.create_multiple_glacier_point_objs(data_map)
glacier_pt0, glacier_pt1 = glacier_point_ls[0], glacier_point_ls[1]
```

    original xy [-141.34499544222683, 60.45529919026818] 4326 maps to datacube (-3250454.7365773427, 361437.5235576865) EPSG:3413
    original xy [-141.34499544222683, 60.45529919026818] 4326 maps to datacube (-3250454.7365773427, 361437.5235576865) EPSG:3413
    subset and load at  58.26 seconds
    original xy [-141.32575672759108, 60.65848956101137] 4326 maps to datacube (-3227246.8706271336, 357759.90272181097) EPSG:3413
    original xy [-141.32575672759108, 60.65848956101137] 4326 maps to datacube (-3227246.8706271336, 357759.90272181097) EPSG:3413
    subset and load at  60.11 seconds

### Manually create [`Glacier`](https://e-marshall.github.io/ITS_LIVE_TOOL/obj_setup.html#glacier), [`Glacier_Point`](https://e-marshall.github.io/ITS_LIVE_TOOL/obj_setup.html#glacier_point), [`Glacier_Centerline`](https://e-marshall.github.io/ITS_LIVE_TOOL/obj_setup.html#glacier_centerline) objects

Create objects that contain the clicked data from the above map
widget.  
These are `coords`, `gpdf`, `urls`

``` python
coords, gpdf, urls = obj_setup.return_clicked_info(data_map)
```

    You have 2 glaciers selected

``` python
coords
```

    [[60.37791914446092, -143.04795214410368],
     [60.36705675717361, -143.64435229781114]]

``` python
label = 'label'
var_ls = ['v','vy','vx','v_error','mapping','satellite_img1','satellite_img2','acquisition_date_img1', 'acquisition_date_img2']
```

``` python
glacier_manual = obj_setup.Glacier(gpdf[0]['NAME'].iloc[0], gpdf[0]['RGIID'].iloc[0], str(gpdf[0].estimate_utm_crs()), 'manual', rgi_outline_from_widget = None)
```

``` python
glacier_manual.name
```

    'Bering Glacier'

``` python
glacier_manual.rgi_id
```

    'RGI60-01.13635'

``` python
glacier_manual.outline_prj.crs
```

    <Projected CRS: EPSG:32607>
    Name: WGS 84 / UTM zone 7N
    Axis Info [cartesian]:
    - E[east]: Easting (metre)
    - N[north]: Northing (metre)
    Area of Use:
    - name: Between 144°W and 138°W, northern hemisphere between equator and 84°N, onshore and offshore. Canada - British Columbia (BC); Yukon. United States (USA) - Alaska (AK).
    - bounds: (-144.0, 0.0, -138.0, 84.0)
    Coordinate Operation:
    - name: UTM zone 7N
    - method: Transverse Mercator
    Datum: World Geodetic System 1984 ensemble
    - Ellipsoid: WGS 84
    - Prime Meridian: Greenwich

``` python
glacier_pt = obj_setup.Glacier_Point(glacier.name, 'acc. zone', glacier.rgi_id, [coords[0][1], coords[0][0]], var_ls)
```

    original xy [-143.04795214410368, 60.37791914446092] 4326 maps to datacube (-3247134.1548154885, 459126.5490621218) EPSG:3413
    original xy [-143.04795214410368, 60.37791914446092] 4326 maps to datacube (-3247134.1548154885, 459126.5490621218) EPSG:3413
    subset and load at  62.53 seconds

``` python
glacier_centerline = obj_setup.Glacier_Centerline('Jorge Montt', 'RGI60-17.06074')
```

### [`Glacier_Point`](https://e-marshall.github.io/ITS_LIVE_TOOL/obj_setup.html#glacier_point)

This object inherits name and RGIID attributes from the
[`Glacier`](https://e-marshall.github.io/ITS_LIVE_TOOL/obj_setup.html#glacier)
object described aboev (or you can input them manually). It takes the
coordinate information specified in the widget and list of variables of
interest and returns an object containing ITS_LIVE image pair time
series datasets for the specified point anda 3x3 pixel cube surrounding
the specified point. Check out the docs for a description of all of the
attributes and methods associated with this object.

``` python
coords
```

    [[61.445551290803365, -147.96202722979135]]

``` python
glacier_pt = obj_setup.Glacier_Point(glacier.name, 'acc. zone', glacier.rgi_id, [coords[0][1], coords[0][0]], var_ls)
```

    original xy [-147.96202722979135, 61.445551290803365] 4326 maps to datacube (-3075868.4013177734, 707973.3167825146) EPSG:3413
    original xy [-147.96202722979135, 61.445551290803365] 4326 maps to datacube (-3075868.4013177734, 707973.3167825146) EPSG:3413
    subset and load at  48.89 seconds

``` python
glacier_pt.cube_around_point
```

<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */
&#10;:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}
&#10;html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}
&#10;.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}
&#10;.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}
&#10;.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}
&#10;.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}
&#10;.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}
&#10;.xr-obj-type {
  color: var(--xr-font-color2);
}
&#10;.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}
&#10;.xr-section-item {
  display: contents;
}
&#10;.xr-section-item input {
  display: none;
}
&#10;.xr-section-item input + label {
  color: var(--xr-disabled-color);
}
&#10;.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}
&#10;.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}
&#10;.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}
&#10;.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}
&#10;.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}
&#10;.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}
&#10;.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}
&#10;.xr-section-summary-in:checked + label:before {
  content: '▼';
}
&#10;.xr-section-summary-in:checked + label > span {
  display: none;
}
&#10;.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}
&#10;.xr-section-inline-details {
  grid-column: 2 / -1;
}
&#10;.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}
&#10;.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}
&#10;.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}
&#10;.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}
&#10;.xr-preview {
  color: var(--xr-font-color3);
}
&#10;.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}
&#10;.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}
&#10;.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}
&#10;.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}
&#10;.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}
&#10;.xr-dim-list:before {
  content: '(';
}
&#10;.xr-dim-list:after {
  content: ')';
}
&#10;.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}
&#10;.xr-has-index {
  font-weight: bold;
}
&#10;.xr-var-list,
.xr-var-item {
  display: contents;
}
&#10;.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}
&#10;.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}
&#10;.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}
&#10;.xr-var-name {
  grid-column: 1;
}
&#10;.xr-var-dims {
  grid-column: 2;
}
&#10;.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}
&#10;.xr-var-preview {
  grid-column: 4;
}
&#10;.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}
&#10;.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}
&#10;.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}
&#10;.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}
&#10;.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}
&#10;.xr-var-data > table {
  float: right;
}
&#10;.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}
&#10;.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}
&#10;dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}
&#10;.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}
&#10;.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}
&#10;.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}
&#10;.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}
&#10;.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                (mid_date: 13831, x: 3, y: 3)
Coordinates:
  * mid_date               (mid_date) datetime64[ns] 2020-02-26T21:15:44.1906...
  * x                      (x) float64 -3.076e+06 -3.076e+06 -3.076e+06
  * y                      (y) float64 7.081e+05 7.079e+05 7.078e+05
    step_count             (mid_date) int64 1 6 7 8 ... 53266 53268 53273 53285
    mapping                int64 0
Data variables:
    v                      (mid_date, y, x) float32 nan nan nan ... nan nan nan
    vy                     (mid_date, y, x) float32 nan nan nan ... nan nan nan
    vx                     (mid_date, y, x) float32 nan nan nan ... nan nan nan
    v_error                (mid_date, y, x) float32 nan nan nan ... nan nan nan
    satellite_img1         (mid_date) object &#x27;2B&#x27; &#x27;5&#x27; &#x27;2B&#x27; &#x27;7&#x27; ... &#x27;7&#x27; &#x27;8&#x27; &#x27;8&#x27;
    satellite_img2         (mid_date) object &#x27;2B&#x27; &#x27;5&#x27; &#x27;2B&#x27; &#x27;7&#x27; ... &#x27;8&#x27; &#x27;8&#x27; &#x27;8&#x27;
    acquisition_date_img1  (mid_date) datetime64[ns] 2019-06-26T21:15:19.0000...
    acquisition_date_img2  (mid_date) datetime64[ns] 2020-10-28T21:16:09 ... ...
    img_separation         (mid_date) float64 491.0 305.0 340.0 ... 352.0 17.0
Attributes: (12/19)
    Conventions:                CF-1.8
    GDAL_AREA_OR_POINT:         Area
    author:                     ITS_LIVE, a NASA MEaSUREs project (its-live.j...
    autoRIFT_parameter_file:    http://its-live-data.s3.amazonaws.com/autorif...
    datacube_software_version:  1.0
    date_created:               03-Oct-2023 04:28:15
    ...                         ...
    s3:                         s3://its-live-data/datacubes/v2/N60W140/ITS_L...
    skipped_granules:           s3://its-live-data/datacubes/v2/N60W140/ITS_L...
    time_standard_img1:         UTC
    time_standard_img2:         UTC
    title:                      ITS_LIVE datacube of image pair velocities
    url:                        https://its-live-data.s3.amazonaws.com/datacu...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-55e5da10-4eba-43fa-af85-ee092173af19' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-55e5da10-4eba-43fa-af85-ee092173af19' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>mid_date</span>: 13831</li><li><span class='xr-has-index'>x</span>: 3</li><li><span class='xr-has-index'>y</span>: 3</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-dcc42c2b-685e-47d1-a927-d41cba5b09ba' class='xr-section-summary-in' type='checkbox'  checked><label for='section-dcc42c2b-685e-47d1-a927-d41cba5b09ba' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>mid_date</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-02-26T21:15:44.190626304 .....</div><input id='attrs-a3235126-f1b2-449d-abba-9d13c1728f4e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a3235126-f1b2-449d-abba-9d13c1728f4e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5ee6ca1a-4f2e-45d3-b226-a0ae3459fd32' class='xr-var-data-in' type='checkbox'><label for='data-5ee6ca1a-4f2e-45d3-b226-a0ae3459fd32' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>midpoint of image 1 and image 2 acquisition date and time with granule&#x27;s centroid longitude and latitude as microseconds</dd><dt><span>standard_name :</span></dt><dd>image_pair_center_date_with_time_separation</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-02-26T21:15:44.190626304&#x27;, &#x27;2004-03-15T20:41:54.249558016&#x27;,
       &#x27;2022-04-14T21:25:39.211025920&#x27;, ..., &#x27;2018-01-13T21:02:14.970299904&#x27;,
       &#x27;2019-12-27T07:04:10.358426112&#x27;, &#x27;2020-06-28T07:04:07.431471104&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-3.076e+06 -3.076e+06 -3.076e+06</div><input id='attrs-34588db1-16b8-4449-9381-233834081c19' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-34588db1-16b8-4449-9381-233834081c19' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c4bc2c00-bfa1-4573-9cbe-7eb09c4e4524' class='xr-var-data-in' type='checkbox'><label for='data-c4bc2c00-bfa1-4573-9cbe-7eb09c4e4524' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>x coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>x coordinate of projection</dd><dt><span>units :</span></dt><dd>metre</dd></dl></div><div class='xr-var-data'><pre>array([-3076027.5, -3075907.5, -3075787.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>7.081e+05 7.079e+05 7.078e+05</div><input id='attrs-b6ddd680-1c84-41b9-9427-6aaab131af45' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b6ddd680-1c84-41b9-9427-6aaab131af45' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b2a7b45c-6bec-4468-8341-5d79ba44d654' class='xr-var-data-in' type='checkbox'><label for='data-b2a7b45c-6bec-4468-8341-5d79ba44d654' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>y coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>y coordinate of projection</dd><dt><span>units :</span></dt><dd>metre</dd></dl></div><div class='xr-var-data'><pre>array([708067.5, 707947.5, 707827.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>step_count</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 6 7 8 ... 53266 53268 53273 53285</div><input id='attrs-6d288e09-8478-463e-967e-575950e9627e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6d288e09-8478-463e-967e-575950e9627e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2090c3b3-7bf7-405a-96bd-e9f80d8fb88b' class='xr-var-data-in' type='checkbox'><label for='data-2090c3b3-7bf7-405a-96bd-e9f80d8fb88b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([    1,     6,     7, ..., 53268, 53273, 53285])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>mapping</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-ec9db8bb-d262-4c88-ab56-b0e72fccb96c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ec9db8bb-d262-4c88-ab56-b0e72fccb96c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-635063dc-29ad-44f8-9e5e-d178affef158' class='xr-var-data-in' type='checkbox'><label for='data-635063dc-29ad-44f8-9e5e-d178affef158' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>PROJCS[&quot;WGS 84 / NSIDC Sea Ice Polar Stereographic North&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Polar_Stereographic&quot;],PARAMETER[&quot;latitude_of_origin&quot;,70],PARAMETER[&quot;central_meridian&quot;,-45],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,SOUTH],AXIS[&quot;Northing&quot;,SOUTH],AUTHORITY[&quot;EPSG&quot;,&quot;3413&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984</dd><dt><span>projected_crs_name :</span></dt><dd>WGS 84 / NSIDC Sea Ice Polar Stereographic North</dd><dt><span>grid_mapping_name :</span></dt><dd>polar_stereographic</dd><dt><span>standard_parallel :</span></dt><dd>70.0</dd><dt><span>straight_vertical_longitude_from_pole :</span></dt><dd>-45.0</dd><dt><span>false_easting :</span></dt><dd>0.0</dd><dt><span>false_northing :</span></dt><dd>0.0</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS[&quot;WGS 84 / NSIDC Sea Ice Polar Stereographic North&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Polar_Stereographic&quot;],PARAMETER[&quot;latitude_of_origin&quot;,70],PARAMETER[&quot;central_meridian&quot;,-45],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,SOUTH],AXIS[&quot;Northing&quot;,SOUTH],AUTHORITY[&quot;EPSG&quot;,&quot;3413&quot;]]</dd><dt><span>GeoTransform :</span></dt><dd>-3076087.5 120.0 0.0 708127.5 0.0 -120.0</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-83bc7d1d-791b-4881-a8eb-9981ae51aa3a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-83bc7d1d-791b-4881-a8eb-9981ae51aa3a' class='xr-section-summary' >Data variables: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(mid_date, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-f30185b4-d8cc-4276-8ea3-6f82b75264de' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f30185b4-d8cc-4276-8ea3-6f82b75264de' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e243a7e9-725c-442b-a404-cfe65c7baba3' class='xr-var-data-in' type='checkbox'><label for='data-e243a7e9-725c-442b-a404-cfe65c7baba3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>velocity magnitude</dd><dt><span>grid_mapping :</span></dt><dd>mapping</dd><dt><span>standard_name :</span></dt><dd>land_ice_surface_velocity</dd><dt><span>units :</span></dt><dd>meter/year</dd></dl></div><div class='xr-var-data'><pre>array([[[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       ...,
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vy</span></div><div class='xr-var-dims'>(mid_date, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-999a62f7-e9b5-408f-bd42-08b71c2e88ae' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-999a62f7-e9b5-408f-bd42-08b71c2e88ae' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-63d824c4-c08c-49e2-9eb8-5d523a2cc827' class='xr-var-data-in' type='checkbox'><label for='data-63d824c4-c08c-49e2-9eb8-5d523a2cc827' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>velocity component in y direction</dd><dt><span>grid_mapping :</span></dt><dd>mapping</dd><dt><span>standard_name :</span></dt><dd>land_ice_surface_y_velocity</dd><dt><span>units :</span></dt><dd>meter/year</dd></dl></div><div class='xr-var-data'><pre>array([[[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       ...,
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vx</span></div><div class='xr-var-dims'>(mid_date, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-98bedb5f-39d0-458f-ad6e-7c25ef8047cd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-98bedb5f-39d0-458f-ad6e-7c25ef8047cd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0d447f0f-13a2-4c81-9774-b8dfb17ff26e' class='xr-var-data-in' type='checkbox'><label for='data-0d447f0f-13a2-4c81-9774-b8dfb17ff26e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>velocity component in x direction</dd><dt><span>grid_mapping :</span></dt><dd>mapping</dd><dt><span>standard_name :</span></dt><dd>land_ice_surface_x_velocity</dd><dt><span>units :</span></dt><dd>meter/year</dd></dl></div><div class='xr-var-data'><pre>array([[[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       ...,
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v_error</span></div><div class='xr-var-dims'>(mid_date, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-d483d13e-c4c8-42ca-bce8-4bb1f7eb7607' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d483d13e-c4c8-42ca-bce8-4bb1f7eb7607' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3af526d9-3bcf-48a6-8092-714b47d95c5f' class='xr-var-data-in' type='checkbox'><label for='data-3af526d9-3bcf-48a6-8092-714b47d95c5f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>velocity magnitude error</dd><dt><span>grid_mapping :</span></dt><dd>mapping</dd><dt><span>standard_name :</span></dt><dd>velocity_error</dd><dt><span>units :</span></dt><dd>meter/year</dd></dl></div><div class='xr-var-data'><pre>array([[[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       ...,
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]],
&#10;       [[nan, nan, nan],
        [nan, nan, nan],
        [nan, nan, nan]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>satellite_img1</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;2B&#x27; &#x27;5&#x27; &#x27;2B&#x27; &#x27;7&#x27; ... &#x27;7&#x27; &#x27;8&#x27; &#x27;8&#x27;</div><input id='attrs-1274dbf2-65e8-4933-a690-d486d57b6753' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1274dbf2-65e8-4933-a690-d486d57b6753' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b6aaa4e0-17d4-48ec-96ad-1d983e3af6b3' class='xr-var-data-in' type='checkbox'><label for='data-b6aaa4e0-17d4-48ec-96ad-1d983e3af6b3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>id of the satellite that acquired image 1</dd><dt><span>standard_name :</span></dt><dd>image1_satellite</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2B&#x27;, &#x27;5&#x27;, &#x27;2B&#x27;, ..., &#x27;7&#x27;, &#x27;8&#x27;, &#x27;8&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>satellite_img2</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;2B&#x27; &#x27;5&#x27; &#x27;2B&#x27; &#x27;7&#x27; ... &#x27;8&#x27; &#x27;8&#x27; &#x27;8&#x27;</div><input id='attrs-61c5956e-a0ef-4464-8749-5ebf60158616' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-61c5956e-a0ef-4464-8749-5ebf60158616' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a74cc111-5071-4107-8844-f96e05861591' class='xr-var-data-in' type='checkbox'><label for='data-a74cc111-5071-4107-8844-f96e05861591' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>id of the satellite that acquired image 2</dd><dt><span>standard_name :</span></dt><dd>image2_satellite</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2B&#x27;, &#x27;5&#x27;, &#x27;2B&#x27;, ..., &#x27;8&#x27;, &#x27;8&#x27;, &#x27;8&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>acquisition_date_img1</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2019-06-26T21:15:19.000000256 .....</div><input id='attrs-bbdfa950-3753-4d5a-826e-a067dd5a1f70' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bbdfa950-3753-4d5a-826e-a067dd5a1f70' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-506efd94-6b4e-4d82-87be-1bf855b42d15' class='xr-var-data-in' type='checkbox'><label for='data-506efd94-6b4e-4d82-87be-1bf855b42d15' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2019-06-26T21:15:19.000000256&#x27;, &#x27;2003-10-15T20:39:20.588030976&#x27;,
       &#x27;2021-10-26T21:25:59.000000256&#x27;, ...,
       &#x27;2017-09-11T21:04:03.087996928&#x27;, &#x27;2019-07-04T07:04:16.857030656&#x27;,
       &#x27;2020-06-20T07:04:03.478413056&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>acquisition_date_img2</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-10-28T21:16:09 ... 2020-07-...</div><input id='attrs-cec0ccfc-4aaf-4c87-bc24-a5a7e2790e7d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cec0ccfc-4aaf-4c87-bc24-a5a7e2790e7d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c9252dd4-51ec-49e6-8697-acc22957af29' class='xr-var-data-in' type='checkbox'><label for='data-c9252dd4-51ec-49e6-8697-acc22957af29' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-10-28T21:16:09.000000000&#x27;, &#x27;2004-08-14T20:44:27.849055872&#x27;,
       &#x27;2022-10-01T21:25:19.000000000&#x27;, ...,
       &#x27;2018-05-17T21:00:26.510779904&#x27;, &#x27;2020-06-20T07:04:03.478413056&#x27;,
       &#x27;2020-07-06T07:04:10.983290112&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>img_separation</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>491.0 305.0 340.0 ... 352.0 17.0</div><input id='attrs-96916ecc-11cb-470b-b62f-9a1dad866292' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-96916ecc-11cb-470b-b62f-9a1dad866292' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-312c0ba5-439d-42a8-b56d-16bacbd572aa' class='xr-var-data-in' type='checkbox'><label for='data-312c0ba5-439d-42a8-b56d-16bacbd572aa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([491., 305., 340., ..., 248., 352.,  17.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-aec84c88-3e50-4988-8e27-ca79cecd882a' class='xr-section-summary-in' type='checkbox'  ><label for='section-aec84c88-3e50-4988-8e27-ca79cecd882a' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>mid_date</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ae35dc00-0b50-4d07-ac01-a9f8d6b55b34' class='xr-index-data-in' type='checkbox'/><label for='index-ae35dc00-0b50-4d07-ac01-a9f8d6b55b34' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2020-02-26 21:15:44.190626304&#x27;,
               &#x27;2004-03-15 20:41:54.249558016&#x27;,
               &#x27;2022-04-14 21:25:39.211025920&#x27;,
               &#x27;2000-10-30 20:52:34.601543936&#x27;,
               &#x27;2019-03-13 21:15:14.190225920&#x27;,
               &#x27;2019-12-06 09:15:20.190706176&#x27;,
               &#x27;2020-08-14 21:15:21.200715008&#x27;,
               &#x27;2019-03-11 21:25:29.181021696&#x27;,
               &#x27;2021-06-16 09:25:20.210305024&#x27;,
               &#x27;2020-01-13 09:25:30.190608896&#x27;,
               ...
               &#x27;2017-11-10 21:02:48.296647936&#x27;,
               &#x27;2017-05-10 21:02:54.593886976&#x27;,
               &#x27;2017-10-17 21:02:51.426091776&#x27;,
               &#x27;2019-12-19 07:04:08.734586880&#x27;,
               &#x27;2016-12-21 21:01:24.286437120&#x27;,
               &#x27;2015-01-05 20:59:48.743781888&#x27;,
               &#x27;2013-05-23 20:59:42.758845952&#x27;,
               &#x27;2018-01-13 21:02:14.970299904&#x27;,
               &#x27;2019-12-27 07:04:10.358426112&#x27;,
               &#x27;2020-06-28 07:04:07.431471104&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;mid_date&#x27;, length=13831, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3934a905-0dfe-4019-a025-b596c9325e6b' class='xr-index-data-in' type='checkbox'/><label for='index-3934a905-0dfe-4019-a025-b596c9325e6b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-3076027.5, -3075907.5, -3075787.5], dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-47eaaeb7-cb3b-4a4e-9645-a87b83c7c4e5' class='xr-index-data-in' type='checkbox'/><label for='index-47eaaeb7-cb3b-4a4e-9645-a87b83c7c4e5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([708067.5, 707947.5, 707827.5], dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4d85af18-5b4c-417c-8b53-dec68e9b8953' class='xr-section-summary-in' type='checkbox'  ><label for='section-4d85af18-5b4c-417c-8b53-dec68e9b8953' class='xr-section-summary' >Attributes: <span>(19)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>GDAL_AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>author :</span></dt><dd>ITS_LIVE, a NASA MEaSUREs project (its-live.jpl.nasa.gov)</dd><dt><span>autoRIFT_parameter_file :</span></dt><dd>http://its-live-data.s3.amazonaws.com/autorift_parameters/v001/autorift_landice_0120m.shp</dd><dt><span>datacube_software_version :</span></dt><dd>1.0</dd><dt><span>date_created :</span></dt><dd>03-Oct-2023 04:28:15</dd><dt><span>date_updated :</span></dt><dd>03-Oct-2023 04:28:15</dd><dt><span>geo_polygon :</span></dt><dd>[[-147.72435568542238, 61.256565131502], [-147.82439810223514, 61.46836997708816], [-147.92599912470595, 61.68028219703766], [-148.02919480794375, 61.89229840144163], [-148.13402230639633, 62.10441512674958], [-148.58599120788892, 62.054078250278586], [-149.03624346792648, 62.00208535775977], [-149.48473356032298, 61.94844718523407], [-149.93141717813754, 61.893174727380945], [-149.81346411880466, 61.682888460616276], [-149.6973192795119, 61.47267643420667], [-149.58294232948407, 61.2625426718196], [-149.4702941000659, 61.05249110806707], [-149.03624346792648, 61.105897743779785], [-148.60054251665875, 61.15771897647252], [-148.1632324896995, 61.20794472007768], [-147.72435568542238, 61.256565131502]]</dd><dt><span>institution :</span></dt><dd>NASA Jet Propulsion Laboratory (JPL), California Institute of Technology</dd><dt><span>latitude :</span></dt><dd>61.58</dd><dt><span>longitude :</span></dt><dd>-148.81</dd><dt><span>proj_polygon :</span></dt><dd>[[-3100000, 700000], [-3075000.0, 700000.0], [-3050000.0, 700000.0], [-3025000.0, 700000.0], [-3000000, 700000], [-3000000.0, 725000.0], [-3000000.0, 750000.0], [-3000000.0, 775000.0], [-3000000, 800000], [-3025000.0, 800000.0], [-3050000.0, 800000.0], [-3075000.0, 800000.0], [-3100000, 800000], [-3100000.0, 775000.0], [-3100000.0, 750000.0], [-3100000.0, 725000.0], [-3100000, 700000]]</dd><dt><span>projection :</span></dt><dd>3413</dd><dt><span>s3 :</span></dt><dd>s3://its-live-data/datacubes/v2/N60W140/ITS_LIVE_vel_EPSG3413_G0120_X-3050000_Y750000.zarr</dd><dt><span>skipped_granules :</span></dt><dd>s3://its-live-data/datacubes/v2/N60W140/ITS_LIVE_vel_EPSG3413_G0120_X-3050000_Y750000.json</dd><dt><span>time_standard_img1 :</span></dt><dd>UTC</dd><dt><span>time_standard_img2 :</span></dt><dd>UTC</dd><dt><span>title :</span></dt><dd>ITS_LIVE datacube of image pair velocities</dd><dt><span>url :</span></dt><dd>https://its-live-data.s3.amazonaws.com/datacubes/v2/N60W140/ITS_LIVE_vel_EPSG3413_G0120_X-3050000_Y750000.zarr</dd></dl></div></li></ul></div></div>

``` python
glacier_pt
```

<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */
&#10;:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}
&#10;html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}
&#10;.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}
&#10;.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}
&#10;.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}
&#10;.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}
&#10;.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}
&#10;.xr-obj-type {
  color: var(--xr-font-color2);
}
&#10;.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}
&#10;.xr-section-item {
  display: contents;
}
&#10;.xr-section-item input {
  display: none;
}
&#10;.xr-section-item input + label {
  color: var(--xr-disabled-color);
}
&#10;.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}
&#10;.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}
&#10;.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}
&#10;.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}
&#10;.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}
&#10;.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}
&#10;.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}
&#10;.xr-section-summary-in:checked + label:before {
  content: '▼';
}
&#10;.xr-section-summary-in:checked + label > span {
  display: none;
}
&#10;.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}
&#10;.xr-section-inline-details {
  grid-column: 2 / -1;
}
&#10;.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}
&#10;.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}
&#10;.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}
&#10;.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}
&#10;.xr-preview {
  color: var(--xr-font-color3);
}
&#10;.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}
&#10;.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}
&#10;.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}
&#10;.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}
&#10;.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}
&#10;.xr-dim-list:before {
  content: '(';
}
&#10;.xr-dim-list:after {
  content: ')';
}
&#10;.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}
&#10;.xr-has-index {
  font-weight: bold;
}
&#10;.xr-var-list,
.xr-var-item {
  display: contents;
}
&#10;.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}
&#10;.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}
&#10;.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}
&#10;.xr-var-name {
  grid-column: 1;
}
&#10;.xr-var-dims {
  grid-column: 2;
}
&#10;.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}
&#10;.xr-var-preview {
  grid-column: 4;
}
&#10;.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}
&#10;.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}
&#10;.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}
&#10;.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}
&#10;.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}
&#10;.xr-var-data > table {
  float: right;
}
&#10;.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}
&#10;.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}
&#10;dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}
&#10;.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}
&#10;.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}
&#10;.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}
&#10;.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}
&#10;.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                (mid_date: 3906, y: 83, x: 83)
Coordinates:
    mapping                int64 0
  * mid_date               (mid_date) datetime64[ns] 2020-01-26T14:27:11.2001...
  * x                      (x) float64 6.017e+05 6.019e+05 ... 6.116e+05
  * y                      (y) float64 4.633e+06 4.633e+06 ... 4.623e+06
    step_count             (mid_date) int64 7 29 30 38 ... 31281 31283 31302
Data variables:
    v                      (mid_date, y, x) float32 37.0 25.0 9.0 ... nan nan
    vy                     (mid_date, y, x) float32 -2.0 -11.0 2.0 ... nan nan
    vx                     (mid_date, y, x) float32 36.0 23.0 9.0 ... nan nan
    v_error                (mid_date, y, x) float32 26.0 26.0 26.0 ... nan nan
    satellite_img1         (mid_date) object &#x27;2A&#x27; &#x27;2A&#x27; &#x27;1A&#x27; &#x27;2A&#x27; ... &#x27;8&#x27; &#x27;8&#x27; &#x27;8&#x27;
    satellite_img2         (mid_date) object &#x27;2A&#x27; &#x27;2A&#x27; &#x27;1A&#x27; &#x27;2B&#x27; ... &#x27;7&#x27; &#x27;9&#x27; &#x27;8&#x27;
    acquisition_date_img1  (mid_date) datetime64[ns] 2020-01-01T14:27:30.9999...
    acquisition_date_img2  (mid_date) datetime64[ns] 2020-02-20T14:26:51 ... ...
    img_separation         (mid_date) float64 50.0 260.0 12.0 ... 536.0 16.0
Attributes: (12/19)
    Conventions:                CF-1.8
    GDAL_AREA_OR_POINT:         Area
    author:                     ITS_LIVE, a NASA MEaSUREs project (its-live.j...
    autoRIFT_parameter_file:    http://its-live-data.s3.amazonaws.com/autorif...
    datacube_software_version:  1.0
    date_created:               25-Sep-2023 21:36:13
    ...                         ...
    s3:                         s3://its-live-data/datacubes/v2/S40W070/ITS_L...
    skipped_granules:           s3://its-live-data/datacubes/v2/S40W070/ITS_L...
    time_standard_img1:         UTC
    time_standard_img2:         UTC
    title:                      ITS_LIVE datacube of image pair velocities
    url:                        https://its-live-data.s3.amazonaws.com/datacu...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-5513e85f-4a93-41f6-b76c-b90ae3d1713e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5513e85f-4a93-41f6-b76c-b90ae3d1713e' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>mid_date</span>: 3906</li><li><span class='xr-has-index'>y</span>: 83</li><li><span class='xr-has-index'>x</span>: 83</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-fa358b93-b92b-4a1e-8e75-39dc67a31a08' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fa358b93-b92b-4a1e-8e75-39dc67a31a08' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>mapping</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-f372e188-7a57-420d-a5cf-ff07b347944d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f372e188-7a57-420d-a5cf-ff07b347944d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2cc2ab6c-68e4-46d5-92ae-474137878f8a' class='xr-var-data-in' type='checkbox'><label for='data-2cc2ab6c-68e4-46d5-92ae-474137878f8a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>PROJCS[&quot;WGS 84 / UTM zone 18S&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,0],PARAMETER[&quot;central_meridian&quot;,-75],PARAMETER[&quot;scale_factor&quot;,0.9996],PARAMETER[&quot;false_easting&quot;,500000],PARAMETER[&quot;false_northing&quot;,10000000],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH],AUTHORITY[&quot;EPSG&quot;,&quot;32718&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984</dd><dt><span>projected_crs_name :</span></dt><dd>WGS 84 / UTM zone 18S</dd><dt><span>grid_mapping_name :</span></dt><dd>transverse_mercator</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>0.0</dd><dt><span>longitude_of_central_meridian :</span></dt><dd>-75.0</dd><dt><span>false_easting :</span></dt><dd>500000.0</dd><dt><span>false_northing :</span></dt><dd>10000000.0</dd><dt><span>scale_factor_at_central_meridian :</span></dt><dd>0.9996</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS[&quot;WGS 84 / UTM zone 18S&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,0],PARAMETER[&quot;central_meridian&quot;,-75],PARAMETER[&quot;scale_factor&quot;,0.9996],PARAMETER[&quot;false_easting&quot;,500000],PARAMETER[&quot;false_northing&quot;,10000000],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH],AUTHORITY[&quot;EPSG&quot;,&quot;32718&quot;]]</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>mid_date</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-01-26T14:27:11.200101376 .....</div><input id='attrs-dda6ca10-a5f1-45a3-9ddb-c09960ce6201' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dda6ca10-a5f1-45a3-9ddb-c09960ce6201' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ef95749a-a2c9-4ba8-87b6-490d19504802' class='xr-var-data-in' type='checkbox'><label for='data-ef95749a-a2c9-4ba8-87b6-490d19504802' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>midpoint of image 1 and image 2 acquisition date and time with granule&#x27;s centroid longitude and latitude as microseconds</dd><dt><span>standard_name :</span></dt><dd>image_pair_center_date_with_time_separation</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-01-26T14:27:11.200101376&#x27;, &#x27;2020-09-07T14:27:31.200430080&#x27;,
       &#x27;2022-10-26T23:57:28.428462080&#x27;, ..., &#x27;2018-01-17T14:32:41.519959040&#x27;,
       &#x27;2021-08-29T14:31:49.364434176&#x27;, &#x27;2017-03-16T14:25:24.933592832&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>6.017e+05 6.019e+05 ... 6.116e+05</div><input id='attrs-34cf7fb5-531f-475a-b325-1c3b84526e38' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-34cf7fb5-531f-475a-b325-1c3b84526e38' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2ef0ae0d-13cf-4a18-b917-9784dedba320' class='xr-var-data-in' type='checkbox'><label for='data-2ef0ae0d-13cf-4a18-b917-9784dedba320' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>x coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd></dl></div><div class='xr-var-data'><pre>array([601732.5, 601852.5, 601972.5, 602092.5, 602212.5, 602332.5, 602452.5,
       602572.5, 602692.5, 602812.5, 602932.5, 603052.5, 603172.5, 603292.5,
       603412.5, 603532.5, 603652.5, 603772.5, 603892.5, 604012.5, 604132.5,
       604252.5, 604372.5, 604492.5, 604612.5, 604732.5, 604852.5, 604972.5,
       605092.5, 605212.5, 605332.5, 605452.5, 605572.5, 605692.5, 605812.5,
       605932.5, 606052.5, 606172.5, 606292.5, 606412.5, 606532.5, 606652.5,
       606772.5, 606892.5, 607012.5, 607132.5, 607252.5, 607372.5, 607492.5,
       607612.5, 607732.5, 607852.5, 607972.5, 608092.5, 608212.5, 608332.5,
       608452.5, 608572.5, 608692.5, 608812.5, 608932.5, 609052.5, 609172.5,
       609292.5, 609412.5, 609532.5, 609652.5, 609772.5, 609892.5, 610012.5,
       610132.5, 610252.5, 610372.5, 610492.5, 610612.5, 610732.5, 610852.5,
       610972.5, 611092.5, 611212.5, 611332.5, 611452.5, 611572.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.633e+06 4.633e+06 ... 4.623e+06</div><input id='attrs-e9bb4d43-7b3d-4e6a-a13d-73d5d0570ada' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e9bb4d43-7b3d-4e6a-a13d-73d5d0570ada' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0d07c79a-2bf4-4494-8b74-82f0e502aed1' class='xr-var-data-in' type='checkbox'><label for='data-0d07c79a-2bf4-4494-8b74-82f0e502aed1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>y coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd></dl></div><div class='xr-var-data'><pre>array([4633267.5, 4633147.5, 4633027.5, 4632907.5, 4632787.5, 4632667.5,
       4632547.5, 4632427.5, 4632307.5, 4632187.5, 4632067.5, 4631947.5,
       4631827.5, 4631707.5, 4631587.5, 4631467.5, 4631347.5, 4631227.5,
       4631107.5, 4630987.5, 4630867.5, 4630747.5, 4630627.5, 4630507.5,
       4630387.5, 4630267.5, 4630147.5, 4630027.5, 4629907.5, 4629787.5,
       4629667.5, 4629547.5, 4629427.5, 4629307.5, 4629187.5, 4629067.5,
       4628947.5, 4628827.5, 4628707.5, 4628587.5, 4628467.5, 4628347.5,
       4628227.5, 4628107.5, 4627987.5, 4627867.5, 4627747.5, 4627627.5,
       4627507.5, 4627387.5, 4627267.5, 4627147.5, 4627027.5, 4626907.5,
       4626787.5, 4626667.5, 4626547.5, 4626427.5, 4626307.5, 4626187.5,
       4626067.5, 4625947.5, 4625827.5, 4625707.5, 4625587.5, 4625467.5,
       4625347.5, 4625227.5, 4625107.5, 4624987.5, 4624867.5, 4624747.5,
       4624627.5, 4624507.5, 4624387.5, 4624267.5, 4624147.5, 4624027.5,
       4623907.5, 4623787.5, 4623667.5, 4623547.5, 4623427.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>step_count</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>7 29 30 38 ... 31281 31283 31302</div><input id='attrs-ad098750-c78b-47c2-b3f3-b044e09cd16b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ad098750-c78b-47c2-b3f3-b044e09cd16b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2ba3d558-b4cc-4ad7-bcaa-4b5b417004f3' class='xr-var-data-in' type='checkbox'><label for='data-2ba3d558-b4cc-4ad7-bcaa-4b5b417004f3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([    7,    29,    30, ..., 31281, 31283, 31302])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d8c95992-3353-4bf1-a1be-f705efb122ad' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d8c95992-3353-4bf1-a1be-f705efb122ad' class='xr-section-summary' >Data variables: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(mid_date, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>37.0 25.0 9.0 37.0 ... nan nan nan</div><input id='attrs-d5cc7205-f46a-4d5d-93c3-af755ba2f824' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d5cc7205-f46a-4d5d-93c3-af755ba2f824' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d8e4b304-78e7-45e3-9c4d-5190d4f5624a' class='xr-var-data-in' type='checkbox'><label for='data-d8e4b304-78e7-45e3-9c4d-5190d4f5624a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>velocity magnitude</dd><dt><span>grid_mapping :</span></dt><dd>mapping</dd><dt><span>standard_name :</span></dt><dd>land_ice_surface_velocity</dd><dt><span>units :</span></dt><dd>meter/year</dd></dl></div><div class='xr-var-data'><pre>array([[[ 37.,  25.,   9., ...,  nan,  nan,  nan],
        [ 37.,  33.,  47., ...,  nan,  nan,  nan],
        [ 41.,  37.,  55., ...,  nan,  nan,  nan],
        ...,
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]],
&#10;       [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        ...,
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]],
&#10;       [[ 20.,  92., 167., ...,  28.,  49.,  33.],
        [ 12.,  nan, 241., ...,  45.,  75., 119.],
        [  5.,  nan,  nan, ...,  46.,   3.,  28.],
        ...,
...
        ...,
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]],
&#10;       [[  1.,   3.,   4., ...,  nan,  nan,  nan],
        [  3.,   6.,   6., ...,  12.,  10.,   9.],
        [  3.,   6.,   5., ...,  13.,  11.,  10.],
        ...,
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]],
&#10;       [[ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan],
        ...,
        [ nan,  nan,  nan, ..., 284., 254., 253.],
        [ nan,  nan,  nan, ..., 289., 251., 244.],
        [ nan,  nan,  nan, ...,  nan,  nan,  nan]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vy</span></div><div class='xr-var-dims'>(mid_date, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-2.0 -11.0 2.0 30.0 ... nan nan nan</div><input id='attrs-b4a45553-5a8d-4452-8d91-87808a18d1d5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b4a45553-5a8d-4452-8d91-87808a18d1d5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cdcc84cf-63d1-49a1-afd3-ca2a8ba2429d' class='xr-var-data-in' type='checkbox'><label for='data-cdcc84cf-63d1-49a1-afd3-ca2a8ba2429d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>velocity component in y direction</dd><dt><span>grid_mapping :</span></dt><dd>mapping</dd><dt><span>standard_name :</span></dt><dd>land_ice_surface_y_velocity</dd><dt><span>units :</span></dt><dd>meter/year</dd></dl></div><div class='xr-var-data'><pre>array([[[  -2.,  -11.,    2., ...,   nan,   nan,   nan],
        [  -2.,   -7.,  -11., ...,   nan,   nan,   nan],
        [  -2.,    2.,    7., ...,   nan,   nan,   nan],
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]],
&#10;       [[  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]],
&#10;       [[   7.,  -79., -138., ...,   23.,  -47.,   31.],
        [   5.,   nan, -225., ...,  -31.,  -53.,  -86.],
        [   0.,   nan,   nan, ...,  -45.,   -1.,   22.],
        ...,
...
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]],
&#10;       [[   1.,    3.,    4., ...,   nan,   nan,   nan],
        [   2.,    6.,    6., ...,  -12.,  -10.,   -8.],
        [   2.,    5.,    4., ...,  -13.,  -11.,   -9.],
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]],
&#10;       [[  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        ...,
        [  nan,   nan,   nan, ...,  -36.,  -85., -111.],
        [  nan,   nan,   nan, ...,  -25.,  -52.,  -76.],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vx</span></div><div class='xr-var-dims'>(mid_date, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>36.0 23.0 9.0 23.0 ... nan nan nan</div><input id='attrs-2d0a50da-44ac-48e1-bb10-4d11d3857594' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2d0a50da-44ac-48e1-bb10-4d11d3857594' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-547bb509-43bc-4add-84ca-19fd1d5764ef' class='xr-var-data-in' type='checkbox'><label for='data-547bb509-43bc-4add-84ca-19fd1d5764ef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>velocity component in x direction</dd><dt><span>grid_mapping :</span></dt><dd>mapping</dd><dt><span>standard_name :</span></dt><dd>land_ice_surface_x_velocity</dd><dt><span>units :</span></dt><dd>meter/year</dd></dl></div><div class='xr-var-data'><pre>array([[[  36.,   23.,    9., ...,   nan,   nan,   nan],
        [  36.,   32.,   46., ...,   nan,   nan,   nan],
        [  41.,   36.,   55., ...,   nan,   nan,   nan],
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]],
&#10;       [[  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]],
&#10;       [[ -19.,   47.,   95., ...,  -15.,  -15.,  -13.],
        [ -11.,   nan,   86., ...,   33.,   52.,   82.],
        [  -5.,   nan,   nan, ...,  -10.,   -3.,  -17.],
        ...,
...
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]],
&#10;       [[   0.,    0.,    0., ...,   nan,   nan,   nan],
        [   2.,    3.,    2., ...,   -1.,   -3.,   -4.],
        [   3.,    4.,    3., ...,    0.,   -2.,   -4.],
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]],
&#10;       [[  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        ...,
        [  nan,   nan,   nan, ..., -282., -239., -227.],
        [  nan,   nan,   nan, ..., -287., -245., -232.],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v_error</span></div><div class='xr-var-dims'>(mid_date, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>26.0 26.0 26.0 25.0 ... nan nan nan</div><input id='attrs-c29c202c-1acb-455f-9053-b957852cf09f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c29c202c-1acb-455f-9053-b957852cf09f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-50e603e6-f440-4891-826a-96443076dde5' class='xr-var-data-in' type='checkbox'><label for='data-50e603e6-f440-4891-826a-96443076dde5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>velocity magnitude error</dd><dt><span>grid_mapping :</span></dt><dd>mapping</dd><dt><span>standard_name :</span></dt><dd>velocity_error</dd><dt><span>units :</span></dt><dd>meter/year</dd></dl></div><div class='xr-var-data'><pre>array([[[26., 26., 26., ..., nan, nan, nan],
        [26., 26., 26., ..., nan, nan, nan],
        [26., 26., 26., ..., nan, nan, nan],
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]],
&#10;       [[nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]],
&#10;       [[56., 57., 57., ..., 57., 57., 57.],
        [56., nan, 57., ..., 56., 56., 56.],
        [56., nan, nan, ..., 57., 56., 57.],
        ...,
...
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]],
&#10;       [[ 9.,  9.,  9., ..., nan, nan, nan],
        [ 9.,  9.,  9., ...,  9.,  9.,  9.],
        [ 9.,  9.,  9., ...,  9.,  9.,  9.],
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]],
&#10;       [[nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        ...,
        [nan, nan, nan, ..., 73., 80., 85.],
        [nan, nan, nan, ..., 73., 75., 79.],
        [nan, nan, nan, ..., nan, nan, nan]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>satellite_img1</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;2A&#x27; &#x27;2A&#x27; &#x27;1A&#x27; &#x27;2A&#x27; ... &#x27;8&#x27; &#x27;8&#x27; &#x27;8&#x27;</div><input id='attrs-252cd3c6-20e1-41ea-9bef-bdf1539a1a16' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-252cd3c6-20e1-41ea-9bef-bdf1539a1a16' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8bf92958-a2c4-4bc1-889e-2174164370e7' class='xr-var-data-in' type='checkbox'><label for='data-8bf92958-a2c4-4bc1-889e-2174164370e7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>id of the satellite that acquired image 1</dd><dt><span>standard_name :</span></dt><dd>image1_satellite</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2A&#x27;, &#x27;2A&#x27;, &#x27;1A&#x27;, ..., &#x27;8&#x27;, &#x27;8&#x27;, &#x27;8&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>satellite_img2</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;2A&#x27; &#x27;2A&#x27; &#x27;1A&#x27; &#x27;2B&#x27; ... &#x27;7&#x27; &#x27;9&#x27; &#x27;8&#x27;</div><input id='attrs-b520739d-acc5-413c-b403-88ad2620bacc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b520739d-acc5-413c-b403-88ad2620bacc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-94a6a842-0cba-4d2a-b2a7-f20f4e4464a4' class='xr-var-data-in' type='checkbox'><label for='data-94a6a842-0cba-4d2a-b2a7-f20f4e4464a4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>id of the satellite that acquired image 2</dd><dt><span>standard_name :</span></dt><dd>image2_satellite</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2A&#x27;, &#x27;2A&#x27;, &#x27;1A&#x27;, ..., &#x27;7&#x27;, &#x27;9&#x27;, &#x27;8&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>acquisition_date_img1</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-01-01T14:27:30.999999744 .....</div><input id='attrs-865e181d-2b7c-4122-8b05-9dd93e454c5d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-865e181d-2b7c-4122-8b05-9dd93e454c5d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-718b4201-4f4d-4c24-b50b-c6f9cb3ba65a' class='xr-var-data-in' type='checkbox'><label for='data-718b4201-4f4d-4c24-b50b-c6f9cb3ba65a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-01-01T14:27:30.999999744&#x27;, &#x27;2020-04-30T14:27:30.999999744&#x27;,
       &#x27;2022-10-20T23:57:28.283366144&#x27;, ...,
       &#x27;2017-12-12T14:32:02.832621056&#x27;, &#x27;2020-12-04T14:32:14.522720000&#x27;,
       &#x27;2017-03-08T14:25:29.875194112&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>acquisition_date_img2</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-02-20T14:26:51 ... 2017-03-...</div><input id='attrs-a34110e6-6105-472b-a2ac-bc5df8cea600' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a34110e6-6105-472b-a2ac-bc5df8cea600' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-098da46c-3690-4354-a0ce-7091e89feaa6' class='xr-var-data-in' type='checkbox'><label for='data-098da46c-3690-4354-a0ce-7091e89feaa6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-02-20T14:26:51.000000000&#x27;, &#x27;2021-01-15T14:27:30.999999744&#x27;,
       &#x27;2022-11-01T23:57:28.131517184&#x27;, ...,
       &#x27;2018-02-22T14:33:19.864871936&#x27;, &#x27;2022-05-24T14:31:23.803738880&#x27;,
       &#x27;2017-03-24T14:25:19.651376128&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>img_separation</span></div><div class='xr-var-dims'>(mid_date)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>50.0 260.0 12.0 ... 73.0 536.0 16.0</div><input id='attrs-877b5c69-2192-4f42-a561-08756e83a30e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-877b5c69-2192-4f42-a561-08756e83a30e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f7b8e220-5ab7-4d17-8039-391b833d5c02' class='xr-var-data-in' type='checkbox'><label for='data-f7b8e220-5ab7-4d17-8039-391b833d5c02' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 50., 260.,  12., ...,  73., 536.,  16.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4335e0c7-4591-4e16-b101-03b64e28dcbf' class='xr-section-summary-in' type='checkbox'  ><label for='section-4335e0c7-4591-4e16-b101-03b64e28dcbf' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>mid_date</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-6cf490db-6f42-410d-aacd-990669e54807' class='xr-index-data-in' type='checkbox'/><label for='index-6cf490db-6f42-410d-aacd-990669e54807' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2020-01-26 14:27:11.200101376&#x27;,
               &#x27;2020-09-07 14:27:31.200430080&#x27;,
               &#x27;2022-10-26 23:57:28.428462080&#x27;,
               &#x27;2019-12-05 02:27:10.191013120&#x27;,
               &#x27;2020-05-07 09:51:27.987412736&#x27;,
               &#x27;2020-09-30 02:27:25.200209920&#x27;,
               &#x27;2017-09-01 02:27:45.170615296&#x27;,
               &#x27;2021-04-08 02:27:30.210130176&#x27;,
               &#x27;2020-07-22 02:27:30.191023104&#x27;,
               &#x27;2005-05-30 02:16:11.279971072&#x27;,
               ...
               &#x27;2014-07-14 14:26:04.238845952&#x27;,
               &#x27;2021-08-05 14:32:01.909836032&#x27;,
               &#x27;2021-08-01 14:31:56.227843072&#x27;,
               &#x27;2021-09-02 14:32:04.156598016&#x27;,
               &#x27;2018-07-20 14:30:10.971715840&#x27;,
               &#x27;2013-04-22 02:27:48.904816896&#x27;,
               &#x27;2018-08-05 14:32:31.694700032&#x27;,
               &#x27;2018-01-17 14:32:41.519959040&#x27;,
               &#x27;2021-08-29 14:31:49.364434176&#x27;,
               &#x27;2017-03-16 14:25:24.933592832&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;mid_date&#x27;, length=3906, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-611070ea-b3e8-4238-b46d-3472f487a1a3' class='xr-index-data-in' type='checkbox'/><label for='index-611070ea-b3e8-4238-b46d-3472f487a1a3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([601732.5, 601852.5, 601972.5, 602092.5, 602212.5, 602332.5,
              602452.5, 602572.5, 602692.5, 602812.5, 602932.5, 603052.5,
              603172.5, 603292.5, 603412.5, 603532.5, 603652.5, 603772.5,
              603892.5, 604012.5, 604132.5, 604252.5, 604372.5, 604492.5,
              604612.5, 604732.5, 604852.5, 604972.5, 605092.5, 605212.5,
              605332.5, 605452.5, 605572.5, 605692.5, 605812.5, 605932.5,
              606052.5, 606172.5, 606292.5, 606412.5, 606532.5, 606652.5,
              606772.5, 606892.5, 607012.5, 607132.5, 607252.5, 607372.5,
              607492.5, 607612.5, 607732.5, 607852.5, 607972.5, 608092.5,
              608212.5, 608332.5, 608452.5, 608572.5, 608692.5, 608812.5,
              608932.5, 609052.5, 609172.5, 609292.5, 609412.5, 609532.5,
              609652.5, 609772.5, 609892.5, 610012.5, 610132.5, 610252.5,
              610372.5, 610492.5, 610612.5, 610732.5, 610852.5, 610972.5,
              611092.5, 611212.5, 611332.5, 611452.5, 611572.5],
             dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-942da6d9-2d36-4977-aa96-fb0a5630c2dd' class='xr-index-data-in' type='checkbox'/><label for='index-942da6d9-2d36-4977-aa96-fb0a5630c2dd' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([4633267.5, 4633147.5, 4633027.5, 4632907.5, 4632787.5, 4632667.5,
              4632547.5, 4632427.5, 4632307.5, 4632187.5, 4632067.5, 4631947.5,
              4631827.5, 4631707.5, 4631587.5, 4631467.5, 4631347.5, 4631227.5,
              4631107.5, 4630987.5, 4630867.5, 4630747.5, 4630627.5, 4630507.5,
              4630387.5, 4630267.5, 4630147.5, 4630027.5, 4629907.5, 4629787.5,
              4629667.5, 4629547.5, 4629427.5, 4629307.5, 4629187.5, 4629067.5,
              4628947.5, 4628827.5, 4628707.5, 4628587.5, 4628467.5, 4628347.5,
              4628227.5, 4628107.5, 4627987.5, 4627867.5, 4627747.5, 4627627.5,
              4627507.5, 4627387.5, 4627267.5, 4627147.5, 4627027.5, 4626907.5,
              4626787.5, 4626667.5, 4626547.5, 4626427.5, 4626307.5, 4626187.5,
              4626067.5, 4625947.5, 4625827.5, 4625707.5, 4625587.5, 4625467.5,
              4625347.5, 4625227.5, 4625107.5, 4624987.5, 4624867.5, 4624747.5,
              4624627.5, 4624507.5, 4624387.5, 4624267.5, 4624147.5, 4624027.5,
              4623907.5, 4623787.5, 4623667.5, 4623547.5, 4623427.5],
             dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a63441d0-b256-4f23-8afd-053971f7a921' class='xr-section-summary-in' type='checkbox'  ><label for='section-a63441d0-b256-4f23-8afd-053971f7a921' class='xr-section-summary' >Attributes: <span>(19)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>GDAL_AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>author :</span></dt><dd>ITS_LIVE, a NASA MEaSUREs project (its-live.jpl.nasa.gov)</dd><dt><span>autoRIFT_parameter_file :</span></dt><dd>http://its-live-data.s3.amazonaws.com/autorift_parameters/v001/autorift_landice_0120m.shp</dd><dt><span>datacube_software_version :</span></dt><dd>1.0</dd><dt><span>date_created :</span></dt><dd>25-Sep-2023 21:36:13</dd><dt><span>date_updated :</span></dt><dd>25-Sep-2023 21:36:13</dd><dt><span>geo_polygon :</span></dt><dd>[[-73.63972075372371, -48.744984111223324], [-73.29979166239863, -48.740469136708676], [-72.95995631265599, -48.73495208332654], [-72.62023338098132, -48.72843369950857], [-72.28064150478471, -48.72091486899348], [-72.29268612706348, -48.496261573233944], [-72.30458343484656, -48.27159724798241], [-72.3163357191524, -48.0469219210457], [-72.32794522181275, -47.82223562000618], [-72.661644027534, -47.82952223181974], [-72.99546594313978, -47.835839242305354], [-73.32939345769323, -47.84118581784196], [-73.66340902514771, -47.84556125246546], [-73.657595464834, -48.07043103920949], [-73.65171032103902, -48.29529144502879], [-73.64575246763346, -48.5201424691683], [-73.63972075372371, -48.744984111223324]]</dd><dt><span>institution :</span></dt><dd>NASA Jet Propulsion Laboratory (JPL), California Institute of Technology</dd><dt><span>latitude :</span></dt><dd>-48.29</dd><dt><span>longitude :</span></dt><dd>-72.98</dd><dt><span>proj_polygon :</span></dt><dd>[[600000, 4600000], [625000.0, 4600000.0], [650000.0, 4600000.0], [675000.0, 4600000.0], [700000, 4600000], [700000.0, 4625000.0], [700000.0, 4650000.0], [700000.0, 4675000.0], [700000, 4700000], [675000.0, 4700000.0], [650000.0, 4700000.0], [625000.0, 4700000.0], [600000, 4700000], [600000.0, 4675000.0], [600000.0, 4650000.0], [600000.0, 4625000.0], [600000, 4600000]]</dd><dt><span>projection :</span></dt><dd>32718</dd><dt><span>s3 :</span></dt><dd>s3://its-live-data/datacubes/v2/S40W070/ITS_LIVE_vel_EPSG32718_G0120_X650000_Y4650000.zarr</dd><dt><span>skipped_granules :</span></dt><dd>s3://its-live-data/datacubes/v2/S40W070/ITS_LIVE_vel_EPSG32718_G0120_X650000_Y4650000.json</dd><dt><span>time_standard_img1 :</span></dt><dd>UTC</dd><dt><span>time_standard_img2 :</span></dt><dd>UTC</dd><dt><span>title :</span></dt><dd>ITS_LIVE datacube of image pair velocities</dd><dt><span>url :</span></dt><dd>https://its-live-data.s3.amazonaws.com/datacubes/v2/S40W070/ITS_LIVE_vel_EPSG32718_G0120_X650000_Y4650000.zarr</dd></dl></div></li></ul></div></div>

### [`Glacier_Centerline`](https://e-marshall.github.io/ITS_LIVE_TOOL/obj_setup.html#glacier_centerline)

Similarly to the
[`Glacier_Point`](https://e-marshall.github.io/ITS_LIVE_TOOL/obj_setup.html#glacier_point)
object, a
[`Glacier_Centerline`](https://e-marshall.github.io/ITS_LIVE_TOOL/obj_setup.html#glacier_centerline)
object inherits some basic information from a
[`Glacier`](https://e-marshall.github.io/ITS_LIVE_TOOL/obj_setup.html#glacier)
object, but this can also be specified manually if you don’t want to
create a
[`Glacier`](https://e-marshall.github.io/ITS_LIVE_TOOL/obj_setup.html#glacier)
method beforehand. A
[`Glacier_Centerline`](https://e-marshall.github.io/ITS_LIVE_TOOL/obj_setup.html#glacier_centerline)
object has attributes called `centerlines` and `main_centerline`. These
are both `Geopandas.GeoDataframe` objects containing OGGM flowline data
associated with this glacier. They also contain ITS_LIVE image pair
velocity time series clipped to the centerline (**still being
implemented**).

``` python
glacier_centerline = obj_setup.Glacier_Centerline('Jorge Montt', 'RGI60-17.06074')
```

``` python
glacier_centerline
```

    <ITS_LIVE_TOOL.obj_setup.Glacier_Centerline>

Each of these objects are meant to act as cotainers to intuitively and
efficiently store different types of data as you process and continue to
work with ITS_LIVE data.

The previous steps demonstrated the data access and organization
functionality of ITS_LIVE_TOOl. The subsequent sections of this notebook
will demonstrate different processing methodologies for working with
this dataset.

# Section 2: Data Processing

## Gaussian Process Regression

We demonstrate a method to develop and apply a Gaussian Process model on
ITS_LIVE point time series data. Gaussian Process are a non-parametric,
Bayesion regression method to model a latent function such as glacier
surface velocity with respect to time, given observations of ice
movement over different time periods.

``` {note}
This method is in active development and should currently be considered to be in 'beta' mode. We provide an example of its implementation but stress that it may not be suitable to apply in other scenarios. Please carefully inspect your dataset and the model parameters to be sure it is appropriate before using in your workflows
```

### Problem:

ITS_LIVE image pair ice velocity time series provide estimates of ice
movement over a broad range of temporal baselines (number of days
between image pairs). The estimates describe different types of ice
movement given different temporal baselines and contain noise inherent
to sensor algorithmic limitations. Given this complex, noisy dataset, we
would like to employ a regression approach to reach an estimate of an
underlying velocity function with inherent uncertainty quantifications.

### Raw data

![ITS_LIVE velocity observations for a single
point](https://github.com/e-marshall/ITS_LIVE_TOOL/blob/main/figs/baltoro_raw_data_example.png?raw=true)

### Gaussian Process model predictions

![Velocity time series predicted by Gaussian Process model based on
ITS_LIVE velocity
observations](https://github.com/e-marshall/ITS_LIVE_TOOL/blob/main/figs/baltoro_gp_example_results.png?raw=true)

``` {note}
Put inversion and other processing steps here? 
```

# Datacube Inversion

# Theory of velocity interpolation for a single point time series

<br> <br>

#### **Problem:**

*Find a smooth regularly spaced timeseries of velocities given a set of
average measurements of possibly overlapping and variable length time
intervals*

<br> <br>

#### **Start: we formulate it as an inverse problem**

*Find a velocity vector $\mathbf{v}$ that minimizes the following
functional:*

<br>

$U(\mathbf{v},\lambda) = \|\mathbf{vInv}\|_r + \lambda \|A_{m}\mathbf{vInv} - \mathbf{vObs}\|$

<br>

- $\mathbf{vObs}$: velocity measurements

- $\mathbf{vInv}$: vector of speeds that we are solving for at a regular
  interval (for example daily)

- $\|.\|_r$: is a roughness norm or a measure of the first derivative

- $\lambda$: can be seen as a Lagrange multiplier (it enforces the
  condition in the expression behind it), or one can think of it as a
  relative weight of how well we want it to fit the data versus how
  smooth the resulting interpolated velocity should be.

- $\mathbf{A_{m}}$: indexing matrix that specifies over which time
  interval a velocity was measured (and averages it appropriately).

<br>

#### **Design Matrix part 1: Date Span Matrix**

For a simple example, assume you want daily velocities for 6 days, and
you have a measurement of the average velocity from day 1 to day 4
($d_1$) and from day 3 to day 5 ($d_2$). We then have:

$$A_{m} = \begin{bmatrix}
        1/4 & 1/4 & 1/4 & 1/4 & 0 & 0 \\ 
        0 & 0 & 1/3 & 1/3 & 1/3 & 0
        \end{bmatrix}$$

<br>

**Dimensions:** The number of rows is equal to the number of
measurements $N$ (same dimension as $\mathbf{vObs}$) and the number of
columns $M$ (same dimension as $\mathbf{vInv}$).

<br>

#### **Design Matrix part 2: Regularization Matrix**

In order to regularize the matrix in time, we create a matrix of
regularization $\mathbf{reg_{mat}}$ which dimensions are $(M-D)$ x $M$
(D is the degree of the derivative used for the regularization), for
which each entry will be depending on the $\lambda$ term and the order
of the term we apply the regularization to (approximation of finite
differences).

**1st derivative regularization:**
$f'(x) \approx \frac{f_{i+1} - f_{i}}{h}$ Matrix size: $(M-1)$ x $M$

Which would result in: $$reg_{mat} = \begin{bmatrix}
                                        -\frac{\lambda}{h} & \frac{\lambda}{h} & 0 & 0 & 0 & 0 \\ 
                                        0 & -\frac{\lambda}{h} & \frac{\lambda}{h}& 0 & 0 & 0 \\
                                        0 & 0 & \frac{\lambda}{h} & \frac{\lambda}{h}& 0 & 0 \\
                                        0 & 0 & 0 & -\frac{\lambda}{h} & \frac{\lambda}{h}& 0 \\
                                        0 & 0 & 0 & 0 & -\frac{\lambda}{h} & \frac{\lambda}{h} \\
                                        \end{bmatrix}$$

<br>

**2nd derivative regularization:**
$f''(x) \approx \frac{f_{i+2} - 2f_{i+1} + f_{i}}{h}$ Matrix size:
$(M-2)$ x $M$

Which would result in: $$reg_{mat} = \begin{bmatrix}
                                        \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} & 0 & 0 & 0 \\ 
                                        0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} & 0 & 0 \\
                                        0 & 0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} & 0 \\
                                        0 & 0 & 0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} \\
                                        \end{bmatrix}$$

<br>

#### **Design Matrix part 3: Assemble the Design Matrix**

And we finally obtain our main design matrix (with 2nd derivative),
which is a concatenation of $A_{m}$ and $reg_{mat}$:

$$A_{reg} = \begin{bmatrix}             \\ & & A_{m} & & & \\ \\
                                        \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} & 0 & 0 & 0 \\ 
                                        0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} & 0 & 0 \\
                                        0 & 0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} & 0 \\
                                        0 & 0 & 0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} \\
                                        \end{bmatrix}$$

<br>

#### **Extend the vector of observations**

Because we added a regularization matrix to our design matrix, we need
to extend our vector of observations $\mathbf{vObs}$ so we can calculate
the inversion:

$$\begin{bmatrix} v_{0} \\ v_{1} \\ ... \\ v_{n} \end{bmatrix} to \begin{bmatrix} v_{0} \\ v_{1} \\ ... \\ v_{n} \\ 0 \\ 0 \\ ... \\ 0 \end{bmatrix} $$

With the amount of 0s appended being $(M-1)$

The obtained velocity vector is then the size of the regular matrix in
time. (We can add a spatial regularization but it increases the
computation time by 3.)

<br>

#### **Final Part: Solve the Linear System of Equations**

$A_{reg}^{T}A_{reg}\mathbf{vInv}= A_{reg}^{T}\mathbf{vObs}$

<br>

Using a linear solver (`np.linalg.solve()`, `scipy.linalg.solve()`,
`torch.linalg.solve()`) find $\mathbf{vInv}$ satisfying the equation,
which is equivalent to solving:
$U(\mathbf{v},\lambda) = \|\mathbf{vInv}\|_r + \lambda \|A_{m}\mathbf{vInv} - \mathbf{vObs}\|$.

We can use a linear solver because the matrix $A_{reg}^{T}A_{reg}$ is
square, symmetrical positive.

<br> <br>

# Inversion applied to ITS_LIVE

#### **ITS_LIVE primary issue:**

ITS_LIVE is a great dataset that achieves high-density measurements
globally, on a long timescale, using the same sensors and method.
However it suffers from one main problem: **mid_dates**, its attribution
of a timestamp for a measurement.

<br>

**Example 1:** ITS_LIVE uses two images to calculate the velocity of the
ice. 1st image is acquired on *January 1st*, 2nd image is acquired on
*January 15th*.

We obtain an average velocity over 15 days:
$v = \frac{displacement}{15 days} = 10 m/day$

The problem is that ITS_LIVE will attribute this velocity to a **precise
point in time** rather than a **period of time**: the velocity of
$10 m/day$ is attributed to *January 7th* at Noon. This is physically
wrong.

It is difficult to work with periods of time, while precise points in
time are much more convenient, which is probably why ITS_LIVE organizes
its data like that.

<br>

**Example 2:** We now have 2 measurements of velocities: - **V1**:
$10 m/day$, timestamp: *January 7th*, Date 1st image acquisition:
*January 1st*, Date 2nd image acquisition: *January 15th*  
- **V2**: $5 m/day$, timestamp: *January 12th*, Date 1st image
acquisition: *January 5th*, Date 2nd image acquisition: *January 19th*

ITS_LIVE would put only 2 timestamps. However there is more information
than just during those two days. The intersection between the two
measurements procures information on the average velocity between
*January 5th* and *January 15th*. Because we now have a fragmentation of
each acquisition into smaller segments, we can also derive refined
average velocities for the following periods of time: - *January 1st*
and *January 5th* - *January 5th* and *January 7th* - *January 7th* and
*January 12th* - *January 12th* and *January 15th* - *January 15th* and
*January 19th*

<br>

#### **Inversion theory applied to ITS_LIVE:**

Let’s consider the same setup at in **Example 2**. We want to linearize
in time to force a sampling of velocities 2 days. Thus, our matrix
$A_{m}$ will have 2 rows (we have 2 average velocities given by
ITS_LIVE), and 10 columns (19 days between the first and last
acquisition dates: *January 1st* and *January 19th*, divided by 2
because we force 2 days sampling):

$$dates = \begin{bmatrix}
        1st & 3rd & 5th & 7th & 9th & 11th & 13th & 15th & 17th & 19th
        \end{bmatrix}$$

$$A_{m} = \begin{bmatrix}
        1/15 & 1/15 & 1/15 & 1/15 & 1/15 & 1/15 & 1/15 & 1/15 & 0    &    0   \\ 
        0    &    0 & 1/14 & 1/14 & 1/14 & 1/14 & 1/14 & 1/14 & 1/14 & 1/14
        \end{bmatrix}$$ <br>

In the matrix above, each column is paired with a date (matrix ’dates).
The first row of $A_{m}$ corresponds to the first velocity measurement.
Because this measurement is the average velocity from *January 1st* to
*January 15th*, every day in between has *1/15* attributed to it in the
matrix (15 days, each contributing equally to the velocity observed).
The 2nd row, representing the 2nd velocity measurement (or observed)
spans 14 days hence why the values there are *1/14*. Note that when a
day is not covered by the velocity time period, the value is 0.

<br>

**Assemble the design matrix:** (regularization in time with 2nd
derivative, Jacobian):

$$A_{reg} = \begin{bmatrix}             1/15 & 1/15 & 1/15 & 1/15 & 1/15 & 1/15 & 1/15 & 1/15 & 0    &    0  \\ 
                                        0    &    0 & 1/14 & 1/14 & 1/14 & 1/14 & 1/14 & 1/14 & 1/14 & 1/14  \\
                                        \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\ 
                                        0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} & 0 & 0 & 0 & 0 & 0 & 0 \\
                                        0 & 0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} & 0 & 0 & 0 & 0 & 0 \\
                                        0 & 0 & 0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} & 0 & 0 & 0 & 0 \\
                                        0 & 0 & 0 & 0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} & 0 & 0 & 0 \\
                                        0 & 0 & 0 & 0 & 0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} & 0 & 0 \\
                                        0 & 0 & 0 & 0 & 0 & 0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} & 0 \\
                                        0 & 0 & 0 & 0 & 0 & 0 & 0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}}\\
                                        \end{bmatrix}$$

<br>

**Extend the vector $\mathbf{vObs}$:**

$$\mathbf{vObs} = \begin{bmatrix} v1 \\ v2 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \end{bmatrix} $$

**Solve the linear system of equation:**

\$\$
                                        \begin{bmatrix}             
                                        1/15 & 0 & \frac{\lambda}{h^{2}} & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                                        1/15 & 0 & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} & 0 & 0 & 0 & 0 & 0 & 0\\
                                        1/15 & 1/14 & 0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} & 0 & 0 & 0 & 0 \\
                                        1/15 & 1/14 & 0 & 0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} & 0 & 0 & 0 \\
                                        1/15 & 1/14 & 0 & 0 & 0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} & 0 & 0 \\
                                        1/15 & 1/14 & 0 & 0 & 0 & 0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}} & 0 \\
                                        1/15 & 1/14 & 0 & 0 & 0 & 0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}}  & 0\\
                                        1/15 & 1/14 & 0 & 0 & 0 & 0 & 0 & \frac{\lambda}{h^{2}} & -2\frac{\lambda}{h^{2}} & \frac{\lambda}{h^{2}}\\
                                        0    & 1/14 & 0 & 0 & 0 & 0 & 0 & 0 & \frac{\lambda}{h^{2}} & 2\frac{\lambda}{h^{2}}\\
                                        0    & 1/14 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & \frac{\lambda}{h^{2}}\\ 

                                        \end{bmatrix}\mathbf{vInv}$$
                                        

$$ = $$ \$\$
\$\$

**You end up with $\mathbf{vInv}$**

<br>

# Input your parameters below

``` python
mission = None # 'None' if you want all the data, 'S1' for Sentinel-1 only, 'L' for Landsat only, etc.. .
lamb = 10 # Smoothing coefficient: the higher the value, the more the inversion favors a smooth output. BAD for surging glaciers, GOOD for non-surging glaciers.
derivative = 2 # Derivative degree for the inversion. Doesn't change much unless you have a specific reasong to choose 1 or 2 (1st or 2nd derivative, Hessian of Jacobian)
day_interval = 12 # Amount of days in between each inversion value. The higher, the faster the inversion. But you also lose in temporal resolution. 12 here because Sentinel-1 repeat-time is 12.
sdate = None # Start date, format 'YYYY-MM-DD' OR None if you want to grab the entire timeseries available
edate = None # End date, format 'YYYY-MM-DD' OR None if you want to grab the entire timeseries available
GPU = True # None if you want to run it on CPU
```

## Select your data

#### **Instructions:**

- Right-click on a glacier to get its RGI ID. It should illuminate in
  blue once you have selected it. You can select multiple glaciers.

  **WARNING:** if you are on a web browser (Cryocloud, OpenScienceLab,
  etc…): right-click will open a pop-up menu. Simply left-click
  somewhere on your screen to make it disappear.

- Left-click on the datacube (*grey* overlay, *red* when you hover your
  mouse over it) you want to download. You can select multiple
  datacubes. When a datacube URL has been fetched, it should print it
  below the GUI.

``` python
urls = []
```

``` python
data_map = interactive.Widget()
```

``` python
data_map.display()
```

    VBox(children=(Map(center=[0, 0], controls=(ZoomControl(options=['position', 'zoom_in_text', 'zoom_in_title', …

``` python
try: 
    coords, gpdf, urls = interactive.return_clicked_info(data_map)
except:
    pass
```

    1

``` python
##### EMMA IN NOTEBOOK 2 ADD 'GeoData' to the import line: from ipyleaflet import Map, WMSLayer, basemaps, GeoData

t = []
wms_url = "https://glims.org/geoserver/ows?SERVICE=WMS&"
wms_layer = WMSLayer(
    url=wms_url,
    layers='GLIMS:RGI',
    transparent=True,
    format='image/png'
)


# Create a Pandas DataFrame with X and Y coordinates
#data = pd.DataFrame({'X': list(fx_map[::50]), 'Y': list(fy_map[::50])})

# Map and label widgets
map = ipyl.Map(basemap=basemaps.Esri.WorldImagery, center=(0, 0), zoom=2)
label = ipyw.Label(layout=ipyw.Layout(width="100%"))

# Create a list to store clicked URLs
urls = []

# geojson layer with hover handler
with open("catalog_v02.json") as f:
    geojson_data = json.load(f)

for feature in geojson_data["features"]:
    feature["properties"]["style"] = {
        "color": "grey",
        "weight": 1,
        "fillColor": "grey",
        "fillOpacity": 0.5,
    }

geojson_layer = ipyl.GeoJSON(data=geojson_data, hover_style={"fillColor": "red"}, selected_style = {"fillColor": "orange"})

def hover_handler(event=None, feature=None, id=None, properties=None):
    label.value = properties["zarr_url"]

def json_handler(event=None, feature=None, id=None, properties=None):    
    zarr_url = properties.get("zarr_url", "N/A")
    urls.append(zarr_url)
    print(f"Clicked URL: {zarr_url}")
    print("All Clicked URLs:", urls)
    '''
    # Plot in orange the polygon clicked on
    json_shape = [{'type': properties['geometry_epsg']['type'], 'coordinates': properties['geometry_epsg']['coordinates']}]
    geom = [shape(i) for i in json_shape]
    json_shape = gpd.GeoDataFrame({'geometry':geom})  
    json_shape = GeoData(geo_dataframe = json_shape,
                style={'color': 'black', 'fillColor': '#3366cc', 'opacity':0.05, 'weight':1.9, 'dashArray':'2', 'fillOpacity':0.6},
                hover_style={'fillColor': 'blue' , 'fillOpacity': 0.2},
                name = 'Cube')

    map.add_layer(json_shape)
    '''

    
    
wms = WebMapService(wms_url)

# Initialize a list to store the geopandas dataframes
gdf_list = []

# Create a function to handle click events
def click_handler(properties=None, **kwargs):


    if kwargs.get('type') == 'contextmenu':
        latlon = kwargs.get('coordinates')
        lat, lon = latlon[0], latlon[1]
        print(f"Clicked at (Lat: {lat}, Lon: {lon})")
        
        # Arrange the coordinates
        
        response = wms.getfeatureinfo(
            layers=['GLIMS:RGI'],
            srs='EPSG:4326',
            bbox=(lon-0.001,lat-0.001,lon+0.001,lat+0.001),
            size=(1,1),
            format='image/jpeg',
            query_layers=['GLIMS:RGI'],
            info_format="application/json",
            xy=(0,0))
        df = gpd.read_file(response)
        gdf_list.append(df)  
        try:
            print(f"You have selected the glacier {df['NAME'].values[0]}, ID: {df['id'].values[0]} ")
        except:
            print(f"This glacier is not recognized by the RGI (maybe an ice-shelf ?) -> Choose another one")
        geo_data = GeoData(geo_dataframe = df,
                   style={'color': 'black', 'fillColor': '#3366cc', 'opacity':0.05, 'weight':1.9, 'dashArray':'2', 'fillOpacity':0.6},
                   hover_style={'fillColor': 'blue' , 'fillOpacity': 0.2},
                   name = 'Glacier')

        gdf_list.append(df) 
        map.add_layer(geo_data)

        


geojson_layer.on_hover(hover_handler)
geojson_layer.on_click(json_handler)


map.add(geojson_layer)

# Add points from the DataFrame to the map
#for index, row in data.iterrows():
#    marker = ipyl.Marker(locatfairbanks ash situationion=(row['Y'], row['X']))
#    map.add_layer(marker)

# Enable zoom when scrolling with the mouse
map.scroll_wheel_zoom = True
ipyw.VBox([map, label])


# Add the WMS layer to the map
map.add_layer(wms_layer)

# Add the click event handler to the map
map.on_interaction(click_handler)

map
```

The following cell ensures you don’t have duplicate glaciers in your
selection. If so, it will automatically remove them. It also verifies
that you have selected a datacube to download. If not, please re-select
it and ensure you are getting a URL after a left-click.

``` python
### EMMA THIS IS THE CELL TO MODIFY

# Get indices of unique geopandas dataframes in case you selected the same glacier twice
unique_values, unique_indices = np.unique(np.array([i['id'] for i in gdf_list]), return_index=True)

# Iterate through the unique indices to recreate the list of geopandas dataframes unique only
gdf_list = [gdf_list[i] for i in unique_indices]

print(f"You have {len(gdf_list)} glaciers selected")

if len(urls) == 0:
    print('Select a datacube to fetch the data !!')

# Print the first dataframe to show the structure of it
gdf_list[0]
```

Just a peek at what the Randolph Glacier Inventory (RGI) gives us for a
glacier object:

``` python
gpdf[0][0]
```

``` python
urls
```

    ['http://its-live-data.s3.amazonaws.com/datacubes/v2/N20E080/ITS_LIVE_vel_EPSG32644_G0120_X750000_Y3250000.zarr']

``` python
try: 
    gpdf_ls = gpdf[0]
except:
    pass
```

``` python
def make_input_dict(coords, gpdf, urls):
    
    mod_urls = [re.sub(r'http', 's3', url) for url in urls]
    mod_urls = [re.sub(r'\.s3\.amazonaws\.com', '', url) for url in mod_urls]
    
    d = {'coords': coords,
     'gpdf': gpdf,
     'urls': mod_urls
        }
    return d
```

``` python
try:
    d = make_input_dict(coords, gpdf, URLs)
    urls = d['urls']
except:
    print(' no input data specified, have you made a map selection?')
```

     no input data specified, have you made a map selection?

The following function creates a dictionnary for a datacube URL. It
prepares the many variables we will use during the cube inversion.

``` python
def create_data_dict(urls):
    # Modify the urls so they can be opened by zarr (replace 'http' by 's3' and delete '.s3.amazonaws.com')
    mod_urls = [re.sub(r'http', 's3', url) for url in urls]
    mod_urls = [re.sub(r'\.s3\.amazonaws\.com', '', url) for url in urls]
    
    # Create storing arrays for the coordinates on-glacier
    X_valid = []
    Y_valid = []
    X_tot = []
    Y_tot = []
    
    # Create an empty directoryimport pickle to hold many variables all tied to the datacubes
    data_dict = {}
    

    # We iterate through the different datacubes so they can each have one instance of the variables below
    for mod_urls in urls:
        zarr_store = None # To store the datacube's information and access its variables
        dates = None # To store the dates at which the inversion will give values
        A_m = None # 1st part of the design matrix
        reg_mat_Inv = None # Regularization in time, 2nd part of the design matrix
        mission = None # If you want to invert specifically for one mission in particular ('S1','L8','L9', etc...)
        index_sort = None # Indices representing the sorted dates (from older to most recent)
        inds_mission = None # Indices representing the sorted dates per mission chosen
        ind_tot = None # Indices representing the indices of the pixels on the GOI
        valid_idx = None # Easting and Northing values of the indices above
        proj_cube = None # Projection of the datacube
        mask_dates = None # Mask that filters out dates outside of desired date range
        
        # Create a dictionary entry for the URL with the desired subsets
        data_dict[mod_urls] = {
            'zarr_store': zarr_store,
            'dates_noinv': dates,
            'A_m': A_m,
            'reg_mat_Inv': reg_mat_Inv,
            'mission': mission,
            'index_sort': index_sort,
            'inds_mission': inds_mission,
            'dates': dates,
            'ind_tot': ind_tot,
            'valid_idx': valid_idx,
            'proj_cube': proj_cube,
            'mask_dates': mask_dates
        }
        
    return data_dict, X_valid, Y_valid, X_tot, Y_tot
```

This function inputs a datacube. It fetches its spatial footprint, and
flags which cells that fall on the glacier shape you selected earlier.
The purpose is to create an array that gathers the spatial intersection
between all the datacubes and glaciers you selected. It also creates a
mask so we only download datacube cells on a glacier, and we don’t
compute the inversion on non-glacier cells in case some get through the
filter.

``` python
def get_extents(url, gpdf, X_tot, Y_tot, X_valid, Y_valid, data_dict):# mission, lamb, derivative, day_interval):
    
    #url = input_data_dict['urls'].iloc[0]
    
    # Open the zarr files
    fs = s3fs.S3FileSystem(anon=True)
    store = zarr.open(s3fs.S3Map(url, s3=fs))
   
    # Update the dictionnary
    data_dict[url]['zarr_store'] = store

    # Get the cube's projection
    proj_cube = store.attrs['projection']

    # Load X and Y of the dataset
    X = store['x'][:]
    Y = store['y'][:]

    # Store the arrays in the total list
    X_tot.append(X)
    Y_tot.append(Y)

    # Load dimensions
    shape_arr = store['v'].shape
    
    Xs, Ys = np.meshgrid(X, Y)
    points = np.array((Xs.flatten(), Ys.flatten())).T

    idx_valid = []
    
    for b in range(len(gpdf)):
        mpath = mplp.Path(list(gpdf[b]['geometry'].to_crs(np.int(proj_cube)).boundary.explode(index_parts = True).iloc[0].coords))
        glacier_mask = mpath.contains_points(points).reshape(Xs.shape)
        # Grab the indices of the points inside the glacier
        idx_valid.append(np.array(np.where(glacier_mask==True)))
        
    idx_valid = np.hstack(idx_valid)
    # Store the valid indices
    data_dict[url]['valid_idx'] = idx_valid
    
    # Store the cube projection
    data_dict[url]['proj_cube'] = proj_cube
    
    # Store the coordinates of the valid Xs and Ys
    X_valid.append([Xs[idx_valid[0][i], idx_valid[1][i]] for i in range(len(idx_valid[0]))])
    Y_valid.append([Ys[idx_valid[0][i], idx_valid[1][i]] for i in range(len(idx_valid[0]))])
    
    return X_tot, Y_tot, X_valid, Y_valid
```

For each datacube you selected, locate the on-glacier cells. Once it has
been done, create an array gathering all the glacier cells you want to
invert.

``` python
try:
    data_dict, X_valid, Y_valid, X_tot, Y_tot = create_data_dict(urls)

    for url in tqdm(range(len(urls))):
        X_tot, Y_tot, X_valid, Y_valid = get_extents(urls[url], gpdf_ls, X_tot, Y_tot, X_valid, Y_valid, data_dict)

    # Create Eastings and Northings arrays based on the Eastings and Northings of the datacubes
    X_arr = np.unique(np.hstack(X_tot))
    Y_arr = np.unique(np.hstack(Y_tot))
    
    # Crop to the GOI (so we avoid over-filling our matrix with NaNs)
    x_min = np.where(np.min(np.hstack(X_valid)) == X_arr)[0][0]
    x_max = np.where(np.max(np.hstack(X_valid)) == X_arr)[0][0]
    y_min = np.where(np.min(np.hstack(Y_valid)) == Y_arr)[0][0]
    y_max = np.where(np.max(np.hstack(Y_valid)) == Y_arr)[0][0]
    
    
    # And now search the indices corresponding to the coordinates 
    x_matches = np.hstack([[np.where(i == X_arr[min(x_min-1, x_max+1):max(x_min-1, x_max+1)])[0][0] for i in row] for row in X_valid]).astype(int)
    y_matches = np.hstack([[np.where(i == Y_arr[min(y_min-1, y_max+1):max(y_min-1, y_max+1)])[0][0] for i in row] for row in Y_valid]).astype(int)
    
    # Create an array representing the glacier
    template = np.zeros((len(Y_arr[min(y_min-1, y_max+1):max(y_min-1, y_max+1)]), len( X_arr[min(x_min-1, x_max+1):max(x_min-1, x_max+1)])))
    template[y_matches, x_matches] = 1
except:
    pass
```

    0it [00:00, ?it/s]

Plot the glacier shape to visualize which cells will be
inverted/downloaded.

``` python
try:
    plt.pcolormesh(X_arr[x_min-1:x_max+1], Y_arr[y_min-1:y_max+1], template)
except:
    pass
```

**Design Matrix**

The following function creates a unique design matrix for each datacube.
This design matrix will then be assembled in the inversion function. The
design matrix shares a common base for each point in the same datacube.
But because each point has a different temporal completness, we modify
the base design matrix to fit the point’s data.

``` python
def design_matrices(url, mission, lamb, derivative, day_interval, sdate, edate):

    # If you passed 'mission' as an argument, it grabs the appropriate values
    if mission:
        # Get the indices of the mission
        filt1 = np.where(data_dict[urls[url]]['zarr_store']['satellite_img1'][:] == mission)
        filt2 = np.where(data_dict[urls[url]]['zarr_store']['satellite_img2'][:] == mission)
        inds_mission = np.intersect1d(filt1[0],filt2[0])

        # Grab only the indices corresponding to the missions
        mid_dates = np.datetime64('1970-01-01') + np.array(data_dict[urls[url]]['zarr_store']['mid_date'][:], dtype='timedelta64[D]')[inds_mission]
        im1 = np.datetime64('1970-01-01') + np.array(data_dict[urls[url]]['zarr_store']['acquisition_date_img1'][:], dtype='timedelta64[D]')[inds_mission]
        im2 = np.datetime64('1970-01-01') + np.array(data_dict[urls[url]]['zarr_store']['acquisition_date_img2'][:], dtype='timedelta64[D]')[inds_mission]
    else:
        # If 'None' was passed as a mission argument, we grab all the available data.
        inds_mission = None
        mid_dates = np.datetime64('1970-01-01') + np.array(data_dict[urls[url]]['zarr_store']['mid_date'][:], dtype='timedelta64[D]')
        im1 = np.datetime64('1970-01-01') + np.array(data_dict[urls[url]]['zarr_store']['acquisition_date_img1'][:], dtype='timedelta64[D]')
        im2 = np.datetime64('1970-01-01') + np.array(data_dict[urls[url]]['zarr_store']['acquisition_date_img2'][:], dtype='timedelta64[D]')
    
    # Get some arrays
    index_sort = np.argsort(np.datetime64('1970-01-01') + np.array(data_dict[urls[url]]['zarr_store']['mid_date'][:], dtype='timedelta64[D]'))
    mid_dates = mid_dates[index_sort]
    im1 = im1[index_sort]
    im2 = im2[index_sort]

    # If sdate is later than the first available date, we find its corresponding index
    try:
        sdate_ind = np.where(mid_dates >= sdate)[0][0]
    except:
        sdate_ind = 0
    
    # If edate is sooner than the last available date, we find its corresponding index
    try:
        edate_ind = np.where(mid_dates > edate)[0][0]
    except:
        edate_ind = None
    
    # Create a False/True mask where True if the date is in the desired range
    mask_dates = np.full(mid_dates.shape, False)
    mask_dates[sdate_ind:edate_ind] = True

    # Keep only the values within the desired range
    mid_dates = mid_dates[mask_dates]
    im1 = im1[mask_dates]
    im2 = im2[mask_dates]

    # Check which im is the smallest (first image, it changes depending on ITS_LIVE's version)
    if im2[0] < im1[0]:
        temp = im1
        im1 = im2
        im2 = temp

    # Create the date array with the new interval dates
    dates_nonum = np.arange(mid_dates[0], mid_dates[-1], timedelta(days=day_interval)).astype(np.datetime64)

    # Convert to numerical
    dates = (dates_nonum - np.datetime64('1970-01-01T00:00:00Z'))/np.timedelta64(1, 's')
    dt_start = (im1 - np.datetime64('1970-01-01T00:00:00Z'))/np.timedelta64(1, 's')
    dt_end = (im2 - np.datetime64('1970-01-01T00:00:00Z'))/np.timedelta64(1, 's')

    # --------------- DESIGN MATRICES --------------- 

    # Initialize matrix
    A_m = np.zeros((mid_dates.shape[0],dates.shape[0]))

    # We have to iterate through the satellite pairs that actually gave a measurement
    for j in range(1, len(mid_dates)):
    # current contents of your for loop

        # Find the middate that is the closest to dt_start (supequal)
        start = np.argmin(np.abs(dates-dt_start[j]))

        # Find the middate that is closest to dt_end (infequal)
        end = np.argmin(dt_end[j] - dates[dates <= dt_end[j]])

        # Divide 1 by the amount of middates between d_start and d_end 
        if end == A_m.shape[1]-1: # If the mid_date is at the end of the array (acquisition im2 equals last mid_date)
            A_m[j, start:] = 1/(1+A_m.shape[1]-start)
        else: # If the measurement is in A's bounds temporally (we can have a satellite pair with the 2nd pair being outside of our mid_dates)
            A_m[j, start:end+1] = 1/(1+end-start) # Attribute to each pixel in the timescale of the satellite pair, the 1/amount of pixel in the pairmid_dates.shape


    # Initialize regularization matrix
    if derivative == 1:
        reg_mat_Inv = np.zeros((A_m.shape[1] -1, A_m.shape[1]))

        for j in range(A_m.shape[1] -1):
            reg_mat_Inv[j, j] = -lamb/day_interval
            reg_mat_Inv[j, j+1] = lamb/day_interval

    elif derivative == 2:
        # Initialize 2nd derivative regularization matrix
        reg_mat_Inv = np.zeros((A_m.shape[1] -1, A_m.shape[1]))

        for j in range(A_m.shape[1] -2):
            reg_mat_Inv[j, j] = lamb/(day_interval**2)
            reg_mat_Inv[j, j+1] = -2*lamb/(day_interval**2)
            reg_mat_Inv[j, j+2] = lamb/(day_interval**2)
            
    data_dict[urls[url]]['A_m'] = A_m
    data_dict[urls[url]]['reg_mat_Inv'] = reg_mat_Inv
    data_dict[urls[url]]['mission'] = mission
    data_dict[urls[url]]['index_sort'] = index_sort
    data_dict[urls[url]]['inds_mission'] = inds_mission
    data_dict[urls[url]]['dates'] = dates_nonum
    data_dict[urls[url]]['dates_noinv'] = mid_dates
    data_dict[urls[url]]['mask_dates']= mask_dates
            
    return data_dict
```

Create one design matrix per datacube

``` python
try:

    for i in tqdm(range(len(urls))):
        design_matrices(i, mission, lamb, derivative, day_interval)
except:
    pass
```

    0it [00:00, ?it/s]

**Point Inversion**

This function inputs a timeseries for a point and inverts it based on
the design matrix build for the datacube the point belongs to.

``` python
def Inv_reg(vObs, data, fillvalue):
    
    # Grab observed velocities
    vObs = vObs[data['index_sort']]
    vObs = vObs[data['mask_dates']]
    
    # Filter out the missions we don't want
    if mission:
        vObs = vObs[data['inds_mission']]  
    
    # Mask the NaNs so we don't compute the inversion for empty rows
    mask = np.logical_not(np.equal(vObs, fillvalue))
    
    # Create a masked velocity vector
    vObs_masked = vObs[mask]
    
    # Append regularization terms to dObs
    vObs_masked= np.hstack((vObs_masked, np.zeros((data['reg_mat_Inv'].shape[0]))))
     
    # Assemble the design matrix
    A_des = np.vstack((data['A_m'][mask], data['reg_mat_Inv']))
    
    # Invert the velocities
    vInv = np.linalg.solve(A_des.T@A_des,A_des.T@vObs_masked)
    #vInv = scipy.linalg.solve(A_des.T@A_des,A_des.T@vObs_masked, lower = False, check_finite=False, assume_a='gen')
    
    return vInv
```

Gather the dates at which we have an observation, spanning all the
selected datacubes

``` python
# Get the total amount of temporal steps
ind_tot = []
for i in urls:
    ind_tot.append(data_dict[i]['dates'])

ind_tot = np.unique(np.hstack(ind_tot))

for i in urls:
    data_dict[i]['ind_tot'] = np.array([np.where(c == ind_tot)[0][0] for c in data_dict[urls[0]]['dates']])
```

**Inversion Calculation**

The following cell loops through all the on-ice cells in the datacubes.
It runs the inversion and outputs a timeseries linearized in time (based
on your input at the beginning of the notebook). It generates a .txt
file that shows how many cells have been inverted. This is a check in
case you get disconnected from your notebook but it still runs in the
background. It also saves the output every 10000 iterations so if the
script crashes, you don’t have to start from scratch.

Once the inversion is complete, it saves the output one last time as a
netcdf file containing: vx, vy, time, x, y.

``` python
if GPU:

    import torch

    device = torch.device("cuda:0" if torch.cuda.is_available() else "cpu")
    '''
    # Migrate to torch & GPU
    for c in range(len(urls)):
        data_dict[urls[c]]['A_m'] = torch.from_numpy(data_dict[urls[c]]['A_m']).to(device)
        data_dict[urls[c]]['reg_mat_Inv'] = torch.from_numpy(data_dict[urls[c]]['reg_mat_Inv']).to(device)
    '''
    
    def Inv_reg_torch(vObs, data, fillvalue, device):
     
        # Grab observed velocities
        vObs = vObs[data['index_sort']]
        vObs = vObs[data['mask_dates']]
        
        # Filter out the missions we don't want
        if mission:
            vObs = vObs[data['inds_mission']]  
        
        # Mask the NaNs so we don't compute the inversion for empty rows
        mask = np.logical_not(np.equal(vObs, fillvalue))
        
        # Create a masked velocity vector
        vObs_masked = torch.from_numpy(vObs[mask])
        
        # Append regularization terms to dObs
        vObs_masked= torch.hstack((vObs_masked, torch.zeros((data['reg_mat_Inv'].shape[0])))).to(device)
         
        # Assemble the design matrix
        A_des = torch.vstack((data['A_m'][mask], data['reg_mat_Inv']))
        
        # Invert the velocities
        vInv = torch.linalg.solve(A_des.T@A_des,A_des.T@vObs_masked.double())
        
        return vInv
    
    vxInv = torch.zeros((len(ind_tot), template.shape[0], template.shape[1])).double().to(device)
    vyInv = torch.zeros((vxInv.shape)).double().to(device)
    
    # Define the total number of iterations
    total_iterations = len(y_matches)
    
    # Create a tqdm object with dynamic_ncols=False to suppress intermediate updates
    # Create a tqdm object with a larger mininterval to suppress intermediate updates
    progress_bar = tqdm(total=total_iterations, dynamic_ncols=False, mininterval=1.0)
    
    
    i = 0
    for c in range(len(urls)):
        valid_idx = data_dict[urls[c]]['valid_idx']
        fillvx = data_dict[urls[c]]['zarr_store']['vx'][:, valid_idx[0][0], valid_idx[1][0]].min() #data_dict[urls[c]]['zarr_store']['vx'].fill_value   fill_value is wrong in the new ITS_LIVE version
        fillvy = data_dict[urls[c]]['zarr_store']['vx'][:, valid_idx[0][0], valid_idx[1][0]].min() #data_dict[urls[c]]['zarr_store']['vy'].fill_value
    
        for V in range(len(valid_idx[0])):
            vxObs = data_dict[urls[c]]['zarr_store']['vx'][:, valid_idx[0][V], valid_idx[1][V]]
            vyObs = data_dict[urls[c]]['zarr_store']['vy'][:, valid_idx[0][V], valid_idx[1][V]]
            vxInv[data_dict[urls[c]]['ind_tot'], y_matches[i], x_matches[i]] = Inv_reg_torch(vxObs, data_dict[urls[c]], fillvx, device)
            vyInv[data_dict[urls[c]]['ind_tot'], y_matches[i], x_matches[i]] = Inv_reg_torch(vyObs, data_dict[urls[c]], fillvy, device)
            
            i += 1
            progress_bar.update(1)  # Update the progress bar

            if i%100 == 0:
                with open("Counter.txt", "w") as text_file:
                    text_file.write(f"Counter: {i}")
            
            if i%5000 == 0:
                
                print(f"Saved at {i}")
                # Get the names of all the glaciers in the datacube 
                #glac_names = np.hstack(np.array([glacier.id.values[0] for glacier in gdf_list]))
                #glac_names = '-'.join(glac_names)

                # Gather the projection of the cube
                #glac_proj = str(np.unique(np.hstack([data_dict[urls[i]]['proj_cube'] for i in range(len(urls))]))[0])

                # Create a new dataset with vx and vy, using attributes from 'ds'
                new_ds = xr.Dataset(
                    {
                        "vx": (["time", "y", "x"], vxInv.cpu().numpy()),
                        "vy": (["time", "y", "x"], vyInv.cpu().numpy()),
                    },
                    coords={
                        "time": ind_tot,
                        "x": X_arr[x_min-1:x_max+1],
                        "y": Y_arr[y_min-1:y_max+1],
                    },
                    attrs=data_dict[urls[0]]['zarr_store'].attrs,
                ).chunk({'time': 1, 'x': 100, 'y': 100})

                from dask.diagnostics import ProgressBar
                write_job = new_ds.to_netcdf(f'VelInv.nc', compute=False)
                with ProgressBar():
                    print(f"Writing to {'VelInv.nc'}")
                    write_job.compute()
    
    # Close the progress bar
    progress_bar.close()

    # Save the dataset
    new_ds = xr.Dataset(
        {
            "vx": (["time", "y", "x"], vxInv.cpu().numpy()),
            "vy": (["time", "y", "x"], vyInv.cpu().numpy()),
        },
        coords={
            "time": ind_tot,
            "x": X_arr[x_min-1:x_max+1],
            "y": Y_arr[y_min-1:y_max+1],
        },
        attrs=data_dict[urls[0]]['zarr_store'].attrs,
    ).chunk({'time': 1, 'x': 100, 'y': 100})
    
    from dask.diagnostics import ProgressBar
    write_job = new_ds.to_netcdf(f'VelInv.nc', compute=False)
    with ProgressBar():
        print(f"Writing to {'VelInv.nc'}")
        write_job.compute()



else:
    
    vxInv = np.zeros((len(ind_tot), template.shape[0], template.shape[1]))
    vyInv = np.zeros((vxInv.shape))
    
    # Define the total number of iterations
    total_iterations = len(y_matches)
    
    # Create a tqdm object with dynamic_ncols=False to suppress intermediate updates
    # Create a tqdm object with a larger mininterval to suppress intermediate updates
    progress_bar = tqdm(total=total_iterations, dynamic_ncols=False, mininterval=1.0)
    
    
    i = 0
    for c in range(len(urls)):
        valid_idx = data_dict[urls[c]]['valid_idx']
        fillvx = data_dict[urls[c]]['zarr_store']['vx'][:, valid_idx[0][0], valid_idx[1][0]].min() #data_dict[urls[c]]['zarr_store']['vx'].fill_value   fill_value is wrong in the new ITS_LIVE version
        fillvy = data_dict[urls[c]]['zarr_store']['vx'][:, valid_idx[0][0], valid_idx[1][0]].min() #data_dict[urls[c]]['zarr_store']['vy'].fill_value
        
        for V in range(len(valid_idx[0])):
            vxObs = data_dict[urls[c]]['zarr_store']['vx'][:, valid_idx[0][V], valid_idx[1][V]]
            vyObs = data_dict[urls[c]]['zarr_store']['vy'][:, valid_idx[0][V], valid_idx[1][V]]
            vxInv[data_dict[urls[c]]['ind_tot'], y_matches[i], x_matches[i]] = Inv_reg(vxObs, data_dict[urls[c]], fillvx)
            vyInv[data_dict[urls[c]]['ind_tot'], y_matches[i], x_matches[i]] = Inv_reg(vyObs, data_dict[urls[c]], fillvy)
            
            i += 1
            if i%100 == 0:
                with open("Counter.txt", "w") as text_file:
                    text_file.write(f"Counter: {i}")
            
            if i%10000 == 0:
                
                print(f"Saved at {i}")
                # Get the names of all the glaciers in the datacube 
                #glac_names = np.hstack(np.array([glacier.id.values[0] for glacier in gdf_list]))
                #glac_names = '-'.join(glac_names)

                # Gather the projection of the cube
                #glac_proj = str(np.unique(np.hstack([data_dict[urls[i]]['proj_cube'] for i in range(len(urls))]))[0])

                # Create a new dataset with vx and vy, using attributes from 'ds'
                new_ds = xr.Dataset(
                    {
                        "vx": (["time", "y", "x"], vxInv),
                        "vy": (["time", "y", "x"], vyInv),
                    },
                    coords={
                        "time": ind_tot,
                        "x": X_arr[x_min-1:x_max+1],
                        "y": Y_arr[y_min-1:y_max+1],
                    },
                    attrs=data_dict[urls[0]]['zarr_store'].attrs,
                ).chunk({'time': 1, 'x': 100, 'y': 100})

                from dask.diagnostics import ProgressBar
                write_job = new_ds.to_netcdf(f'Malaspina.nc', compute=False)
                with ProgressBar():
                    print(f"Writing to {'Malaspina.nc'}")
                    write_job.compute()
            progress_bar.update(1)  # Update the progress bar
    
    # Close the progress bar
    progress_bar.close()

    # Save the dataset
    new_ds = xr.Dataset(
        {
            "vx": (["time", "y", "x"], vxInv),
            "vy": (["time", "y", "x"], vyInv),
        },
        coords={
            "time": ind_tot,
            "x": X_arr[x_min-1:x_max+1],
            "y": Y_arr[y_min-1:y_max+1],
        },
        attrs=data_dict[urls[0]]['zarr_store'].attrs,
    ).chunk({'time': 1, 'x': 100, 'y': 100})

    from dask.diagnostics import ProgressBar
    write_job = new_ds.to_netcdf(f'Malaspina.nc', compute=False)
    with ProgressBar():
        print(f"Writing to {'Malaspina.nc'}")
        write_job.compute()
```
